var CryptoJS=CryptoJS||function(b,c){var d={},e=d.lib={},f=function(){},g=e.Base={extend:function(b){f.prototype=this;var c=new f;b&&c.mixIn(b);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var b=this.extend();b.init.apply(b,arguments);return b},init:function(){},mixIn:function(b){for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}},
h=e.WordArray=g.extend({init:function(b,d){b=this.words=b||[];this.sigBytes=d!=c?d:4*b.length},toString:function(b){return(b||n).stringify(this)},concat:function(b){var c=this.words,d=b.words,e=this.sigBytes;b=b.sigBytes;this.clamp();if(e%4)for(var g=0;g<b;g++)c[e+g>>>2]|=(d[g>>>2]>>>24-g%4*8&255)<<24-(e+g)%4*8;else if(65535<d.length)for(g=0;g<b;g+=4)c[e+g>>>2]=d[g>>>2];else c.push.apply(c,d);this.sigBytes+=b;return this},clamp:function(){var c=this.words,d=this.sigBytes;c[d>>>2]&=4294967295<<32-
d%4*8;c.length=b.ceil(d/4)},clone:function(){var b=g.clone.call(this);b.words=this.words.slice(0);return b},random:function(c){for(var d=[],g=0;g<c;g+=4)d.push(4294967296*b.random()|0);return new h.init(d,c)}}),l=d.enc={},n=l.Hex={stringify:function(b){var c=b.words;b=b.sigBytes;for(var d=[],g=0;g<b;g++){var e=c[g>>>2]>>>24-g%4*8&255;d.push((e>>>4).toString(16));d.push((e&15).toString(16))}return d.join("")},parse:function(b){for(var c=b.length,d=[],g=0;g<c;g+=2)d[g>>>3]|=parseInt(b.substr(g,2),16)<<
24-g%8*4;return new h.init(d,c/2)}},m=l.Latin1={stringify:function(b){var c=b.words;b=b.sigBytes;for(var d=[],g=0;g<b;g++)d.push(String.fromCharCode(c[g>>>2]>>>24-g%4*8&255));return d.join("")},parse:function(b){for(var c=b.length,d=[],g=0;g<c;g++)d[g>>>2]|=(b.charCodeAt(g)&255)<<24-g%4*8;return new h.init(d,c)}},w=l.Utf8={stringify:function(b){try{return decodeURIComponent(escape(m.stringify(b)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(b){return m.parse(unescape(encodeURIComponent(b)))}},
v=e.BufferedBlockAlgorithm=g.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(b){"string"==typeof b&&(b=w.parse(b));this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(c){var d=this._data,g=d.words,e=d.sigBytes,f=this.blockSize,l=e/(4*f),l=c?b.ceil(l):b.max((l|0)-this._minBufferSize,0);c=l*f;e=b.min(4*c,e);if(c){for(var m=0;m<c;m+=f)this._doProcessBlock(g,m);m=g.splice(0,c);d.sigBytes-=e}return new h.init(m,e)},clone:function(){var b=g.clone.call(this);
b._data=this._data.clone();return b},_minBufferSize:0});e.Hasher=v.extend({cfg:g.extend(),init:function(b){this.cfg=this.cfg.extend(b);this.reset()},reset:function(){v.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(b){b&&this._append(b);return this._doFinalize()},blockSize:16,_createHelper:function(b){return function(c,d){return(new b.init(d)).finalize(c)}},_createHmacHelper:function(b){return function(c,d){return(new z.HMAC.init(b,
d)).finalize(c)}}});var z=d.algo={};return d}(Math);
(function(){var b=CryptoJS,c=b.lib.WordArray;b.enc.Base64={stringify:function(b){var c=b.words,f=b.sigBytes,g=this._map;b.clamp();b=[];for(var h=0;h<f;h+=3)for(var l=(c[h>>>2]>>>24-h%4*8&255)<<16|(c[h+1>>>2]>>>24-(h+1)%4*8&255)<<8|c[h+2>>>2]>>>24-(h+2)%4*8&255,n=0;4>n&&h+.75*n<f;n++)b.push(g.charAt(l>>>6*(3-n)&63));if(c=g.charAt(64))for(;b.length%4;)b.push(c);return b.join("")},parse:function(b){var e=b.length,f=this._map,g=f.charAt(64);g&&(g=b.indexOf(g),-1!=g&&(e=g));for(var g=[],h=0,l=0;l<e;l++)if(l%
4){var n=f.indexOf(b.charAt(l-1))<<l%4*2,m=f.indexOf(b.charAt(l))>>>6-l%4*2;g[h>>>2]|=(n|m)<<24-h%4*8;h++}return c.create(g,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
(function(b){function c(b,c,d,g,e,f,h){b=b+(c&d|~c&g)+e+h;return(b<<f|b>>>32-f)+c}function d(b,c,d,g,e,f,h){b=b+(c&g|d&~g)+e+h;return(b<<f|b>>>32-f)+c}function e(b,c,d,g,e,f,h){b=b+(c^d^g)+e+h;return(b<<f|b>>>32-f)+c}function f(b,c,d,g,e,f,h){b=b+(d^(c|~g))+e+h;return(b<<f|b>>>32-f)+c}for(var g=CryptoJS,h=g.lib,l=h.WordArray,n=h.Hasher,h=g.algo,m=[],w=0;64>w;w++)m[w]=4294967296*b.abs(b.sin(w+1))|0;h=h.MD5=n.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},
_doProcessBlock:function(b,g){for(var h=0;16>h;h++){var l=g+h,n=b[l];b[l]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360}var h=this._hash.words,l=b[g+0],n=b[g+1],w=b[g+2],G=b[g+3],K=b[g+4],N=b[g+5],O=b[g+6],C=b[g+7],Q=b[g+8],R=b[g+9],V=b[g+10],X=b[g+11],Y=b[g+12],S=b[g+13],W=b[g+14],M=b[g+15],p=h[0],q=h[1],r=h[2],u=h[3],p=c(p,q,r,u,l,7,m[0]),u=c(u,p,q,r,n,12,m[1]),r=c(r,u,p,q,w,17,m[2]),q=c(q,r,u,p,G,22,m[3]),p=c(p,q,r,u,K,7,m[4]),u=c(u,p,q,r,N,12,m[5]),r=c(r,u,p,q,O,17,m[6]),q=c(q,r,u,p,C,22,m[7]),
p=c(p,q,r,u,Q,7,m[8]),u=c(u,p,q,r,R,12,m[9]),r=c(r,u,p,q,V,17,m[10]),q=c(q,r,u,p,X,22,m[11]),p=c(p,q,r,u,Y,7,m[12]),u=c(u,p,q,r,S,12,m[13]),r=c(r,u,p,q,W,17,m[14]),q=c(q,r,u,p,M,22,m[15]),p=d(p,q,r,u,n,5,m[16]),u=d(u,p,q,r,O,9,m[17]),r=d(r,u,p,q,X,14,m[18]),q=d(q,r,u,p,l,20,m[19]),p=d(p,q,r,u,N,5,m[20]),u=d(u,p,q,r,V,9,m[21]),r=d(r,u,p,q,M,14,m[22]),q=d(q,r,u,p,K,20,m[23]),p=d(p,q,r,u,R,5,m[24]),u=d(u,p,q,r,W,9,m[25]),r=d(r,u,p,q,G,14,m[26]),q=d(q,r,u,p,Q,20,m[27]),p=d(p,q,r,u,S,5,m[28]),u=d(u,p,
q,r,w,9,m[29]),r=d(r,u,p,q,C,14,m[30]),q=d(q,r,u,p,Y,20,m[31]),p=e(p,q,r,u,N,4,m[32]),u=e(u,p,q,r,Q,11,m[33]),r=e(r,u,p,q,X,16,m[34]),q=e(q,r,u,p,W,23,m[35]),p=e(p,q,r,u,n,4,m[36]),u=e(u,p,q,r,K,11,m[37]),r=e(r,u,p,q,C,16,m[38]),q=e(q,r,u,p,V,23,m[39]),p=e(p,q,r,u,S,4,m[40]),u=e(u,p,q,r,l,11,m[41]),r=e(r,u,p,q,G,16,m[42]),q=e(q,r,u,p,O,23,m[43]),p=e(p,q,r,u,R,4,m[44]),u=e(u,p,q,r,Y,11,m[45]),r=e(r,u,p,q,M,16,m[46]),q=e(q,r,u,p,w,23,m[47]),p=f(p,q,r,u,l,6,m[48]),u=f(u,p,q,r,C,10,m[49]),r=f(r,u,p,q,
W,15,m[50]),q=f(q,r,u,p,N,21,m[51]),p=f(p,q,r,u,Y,6,m[52]),u=f(u,p,q,r,G,10,m[53]),r=f(r,u,p,q,V,15,m[54]),q=f(q,r,u,p,n,21,m[55]),p=f(p,q,r,u,Q,6,m[56]),u=f(u,p,q,r,M,10,m[57]),r=f(r,u,p,q,O,15,m[58]),q=f(q,r,u,p,S,21,m[59]),p=f(p,q,r,u,K,6,m[60]),u=f(u,p,q,r,X,10,m[61]),r=f(r,u,p,q,w,15,m[62]),q=f(q,r,u,p,R,21,m[63]);h[0]=h[0]+p|0;h[1]=h[1]+q|0;h[2]=h[2]+r|0;h[3]=h[3]+u|0},_doFinalize:function(){var c=this._data,d=c.words,g=8*this._nDataBytes,e=8*c.sigBytes;d[e>>>5]|=128<<24-e%32;var f=b.floor(g/
4294967296);d[(e+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;d[(e+64>>>9<<4)+14]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360;c.sigBytes=4*(d.length+1);this._process();c=this._hash;d=c.words;for(g=0;4>g;g++)e=d[g],d[g]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;return c},clone:function(){var b=n.clone.call(this);b._hash=this._hash.clone();return b}});g.MD5=n._createHelper(h);g.HmacMD5=n._createHmacHelper(h)})(Math);
(function(){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,c=b.algo,f=c.EvpKDF=d.extend({cfg:d.extend({keySize:4,hasher:c.MD5,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(b,c){for(var d=this.cfg,f=d.hasher.create(),m=e.create(),w=m.words,v=d.keySize,d=d.iterations;w.length<v;){z&&f.update(z);var z=f.update(b).finalize(c);f.reset();for(var y=1;y<d;y++)z=f.finalize(z),f.reset();m.concat(z)}m.sigBytes=4*v;return m}});b.EvpKDF=function(b,c,d){return f.create(d).compute(b,
c)}})();
CryptoJS.lib.Cipher||function(b){var c=CryptoJS,d=c.lib,e=d.Base,f=d.WordArray,g=d.BufferedBlockAlgorithm,h=c.enc.Base64,l=c.algo.EvpKDF,n=d.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(b,c){return this.create(this._ENC_XFORM_MODE,b,c)},createDecryptor:function(b,c){return this.create(this._DEC_XFORM_MODE,b,c)},init:function(b,c,d){this.cfg=this.cfg.extend(d);this._xformMode=b;this._key=c;this.reset()},reset:function(){g.reset.call(this);this._doReset()},process:function(b){this._append(b);return this._process()},
finalize:function(b){b&&this._append(b);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(c,d,g){return("string"==typeof d?E:y).encrypt(b,c,d,g)},decrypt:function(c,d,g){return("string"==typeof d?E:y).decrypt(b,c,d,g)}}}});d.StreamCipher=n.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var m=c.mode={},w=function(c,d,g){var e=this._iv;e?this._iv=b:e=this._prevBlock;for(var f=0;f<g;f++)c[d+f]^=
e[f]},v=(d.BlockCipherMode=e.extend({createEncryptor:function(b,c){return this.Encryptor.create(b,c)},createDecryptor:function(b,c){return this.Decryptor.create(b,c)},init:function(b,c){this._cipher=b;this._iv=c}})).extend();v.Encryptor=v.extend({processBlock:function(b,c){var d=this._cipher,g=d.blockSize;w.call(this,b,c,g);d.encryptBlock(b,c);this._prevBlock=b.slice(c,c+g)}});v.Decryptor=v.extend({processBlock:function(b,c){var d=this._cipher,g=d.blockSize,e=b.slice(c,c+g);d.decryptBlock(b,c);w.call(this,
b,c,g);this._prevBlock=e}});m=m.CBC=v;v=(c.pad={}).Pkcs7={pad:function(b,c){for(var d=4*c,d=d-b.sigBytes%d,g=d<<24|d<<16|d<<8|d,e=[],h=0;h<d;h+=4)e.push(g);d=f.create(e,d);b.concat(d)},unpad:function(b){b.sigBytes-=b.words[b.sigBytes-1>>>2]&255}};d.BlockCipher=n.extend({cfg:n.cfg.extend({mode:m,padding:v}),reset:function(){n.reset.call(this);var b=this.cfg,c=b.iv,b=b.mode;if(this._xformMode==this._ENC_XFORM_MODE)var d=b.createEncryptor;else d=b.createDecryptor,this._minBufferSize=1;this._mode=d.call(b,
this,c&&c.words)},_doProcessBlock:function(b,c){this._mode.processBlock(b,c)},_doFinalize:function(){var b=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){b.pad(this._data,this.blockSize);var c=this._process(!0)}else c=this._process(!0),b.unpad(c);return c},blockSize:4});var z=d.CipherParams=e.extend({init:function(b){this.mixIn(b)},toString:function(b){return(b||this.formatter).stringify(this)}}),m=(c.format={}).OpenSSL={stringify:function(b){var c=b.ciphertext;b=b.salt;return(b?f.create([1398893684,
1701076831]).concat(b).concat(c):c).toString(h)},parse:function(b){b=h.parse(b);var c=b.words;if(1398893684==c[0]&&1701076831==c[1]){var d=f.create(c.slice(2,4));c.splice(0,4);b.sigBytes-=16}return z.create({ciphertext:b,salt:d})}},y=d.SerializableCipher=e.extend({cfg:e.extend({format:m}),encrypt:function(b,c,d,g){g=this.cfg.extend(g);var e=b.createEncryptor(d,g);c=e.finalize(c);e=e.cfg;return z.create({ciphertext:c,key:d,iv:e.iv,algorithm:b,mode:e.mode,padding:e.padding,blockSize:b.blockSize,formatter:g.format})},
decrypt:function(b,c,d,g){g=this.cfg.extend(g);c=this._parse(c,g.format);return b.createDecryptor(d,g).finalize(c.ciphertext)},_parse:function(b,c){return"string"==typeof b?c.parse(b,this):b}}),c=(c.kdf={}).OpenSSL={execute:function(b,c,d,g){g||(g=f.random(8));b=l.create({keySize:c+d}).compute(b,g);d=f.create(b.words.slice(c),4*d);b.sigBytes=4*c;return z.create({key:b,iv:d,salt:g})}},E=d.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:c}),encrypt:function(b,c,d,g){g=this.cfg.extend(g);d=g.kdf.execute(d,
b.keySize,b.ivSize);g.iv=d.iv;b=y.encrypt.call(this,b,c,d.key,g);b.mixIn(d);return b},decrypt:function(b,c,d,g){g=this.cfg.extend(g);c=this._parse(c,g.format);d=g.kdf.execute(d,b.keySize,b.ivSize,c.salt);g.iv=d.iv;return y.decrypt.call(this,b,c,d.key,g)}})}();
(function(){for(var b=CryptoJS,c=b.lib.BlockCipher,d=b.algo,e=[],f=[],g=[],h=[],l=[],n=[],m=[],w=[],v=[],z=[],y=[],E=0;256>E;E++)y[E]=128>E?E<<1:E<<1^283;for(var L=0,J=0,E=0;256>E;E++){var G=J^J<<1^J<<2^J<<3^J<<4,G=G>>>8^G&255^99;e[L]=G;f[G]=L;var K=y[L],N=y[K],O=y[N],C=257*y[G]^16843008*G;g[L]=C<<24|C>>>8;h[L]=C<<16|C>>>16;l[L]=C<<8|C>>>24;n[L]=C;C=16843009*O^65537*N^257*K^16843008*L;m[G]=C<<24|C>>>8;w[G]=C<<16|C>>>16;v[G]=C<<8|C>>>24;z[G]=C;L?(L=K^y[y[y[O^K]]],J^=y[y[J]]):L=J=1}var Q=[0,1,2,4,8,
16,32,64,128,27,54],d=d.AES=c.extend({_doReset:function(){for(var b=this._key,c=b.words,d=b.sigBytes/4,b=4*((this._nRounds=d+6)+1),g=this._keySchedule=[],f=0;f<b;f++)if(f<d)g[f]=c[f];else{var h=g[f-1];f%d?6<d&&4==f%d&&(h=e[h>>>24]<<24|e[h>>>16&255]<<16|e[h>>>8&255]<<8|e[h&255]):(h=h<<8|h>>>24,h=e[h>>>24]<<24|e[h>>>16&255]<<16|e[h>>>8&255]<<8|e[h&255],h^=Q[f/d|0]<<24);g[f]=g[f-d]^h}c=this._invKeySchedule=[];for(d=0;d<b;d++)f=b-d,h=d%4?g[f]:g[f-4],c[d]=4>d||4>=f?h:m[e[h>>>24]]^w[e[h>>>16&255]]^v[e[h>>>
8&255]]^z[e[h&255]]},encryptBlock:function(b,c){this._doCryptBlock(b,c,this._keySchedule,g,h,l,n,e)},decryptBlock:function(b,c){var d=b[c+1];b[c+1]=b[c+3];b[c+3]=d;this._doCryptBlock(b,c,this._invKeySchedule,m,w,v,z,f);d=b[c+1];b[c+1]=b[c+3];b[c+3]=d},_doCryptBlock:function(b,c,d,g,e,f,h,l){for(var m=this._nRounds,n=b[c]^d[0],w=b[c+1]^d[1],v=b[c+2]^d[2],y=b[c+3]^d[3],z=4,D=1;D<m;D++)var E=g[n>>>24]^e[w>>>16&255]^f[v>>>8&255]^h[y&255]^d[z++],C=g[w>>>24]^e[v>>>16&255]^f[y>>>8&255]^h[n&255]^d[z++],J=
g[v>>>24]^e[y>>>16&255]^f[n>>>8&255]^h[w&255]^d[z++],y=g[y>>>24]^e[n>>>16&255]^f[w>>>8&255]^h[v&255]^d[z++],n=E,w=C,v=J;E=(l[n>>>24]<<24|l[w>>>16&255]<<16|l[v>>>8&255]<<8|l[y&255])^d[z++];C=(l[w>>>24]<<24|l[v>>>16&255]<<16|l[y>>>8&255]<<8|l[n&255])^d[z++];J=(l[v>>>24]<<24|l[y>>>16&255]<<16|l[n>>>8&255]<<8|l[w&255])^d[z++];y=(l[y>>>24]<<24|l[n>>>16&255]<<16|l[w>>>8&255]<<8|l[v&255])^d[z++];b[c]=E;b[c+1]=C;b[c+2]=J;b[c+3]=y},keySize:8});b.AES=c._createHelper(d)})();function CardUI(){this.menu=[{text:"",level:0,parentId:null}];this.curItem=0;this.context=this.canvas=null;this.nextId=1;this.cols=[];this.backButton=null;this.fadeTime=200;this.drawNum=0;this.nextDrawDirection=void 0;this.visible=!0;this.rootId=""}
CardUI.prototype.init=function(b){void 0!==b?(this.rootId="#"+b,$(this.rootId).addClass("CardUI")):(this.rootId="#CardUI-"+(new Date).getTime(),b=$("<div class='CardUI'></div>"),b.attr("id",this.rootId.substring(1)),$("body").append(b));$(this.rootId).append('<div class="CardUI-column"><div class="CardUI-col1 CardUI-col-container"></div><div class="CardUI-div-center-helper"></div></div><div class="CardUI-column"><div class="CardUI-col2 CardUI-col-container"></div><div class="CardUI-div-center-helper"></div></div><div class="CardUI-column"><div class="CardUI-col3 CardUI-col-container"></div><div class="CardUI-div-center-helper"></div></div>');this.cols[0]=
$(this.rootId+" div.CardUI-col1");this.cols[1]=$(this.rootId+" div.CardUI-col2");this.cols[2]=$(this.rootId+" div.CardUI-col3");this.backButton=$("#CardUI-BackButton");var c=this;$("#CardUI-BackButton").click(function(b){c.onItemClick(c.menu[c.curItem].parentId)});$(window).resize(function(){c.refreshPositions()});$(this.rootId).fadeIn("fast")};
CardUI.prototype.addCard=function(b,c){var d=new Card(c,this);d.id=this.nextId;d.parentId=b;d.level=this.menu[b].level+1;d.buttons||(d.buttons=[]);d.inputs||(d.inputs=[]);this.menu[d.id]=d;this.nextId++;return d};CardUI.prototype.setVisible=function(b){this.visible=b;!1===b?$(this.rootId).fadeOut("fast"):$(this.rootId).fadeIn("fast")};CardUI.prototype.setChildsVisibility=function(b,c){if(b){var d=this.getChilds(b);for(i in d)d[i].visible=c}};
CardUI.prototype.setCardVisibility=function(b,c){b&&(this.menu[b].visible=c)};CardUI.prototype.removeAllChilds=function(b){for(var c=0;c<this.menu.length;c++)void 0!=this.menu[c]&&this.menu[c].parentId==b&&this.removeCard(this.menu[c].id)};CardUI.prototype.removeCardByIdx=function(b,c){for(var d=0,e=0;e<this.menu.length;e++)if(void 0!=this.menu[e]&&this.menu[e].parentId==b){if(d==c)return this.removeCard(this.menu[e].id),!0;d++}return!1};
CardUI.prototype.removeCard=function(b){b&&this.menu[b]&&(this.menu[b]=void 0,this.removeAllChilds(b))};CardUI.prototype.parent=function(b){return this.menu[b].parentId};CardUI.prototype.get=function(b){return this.menu[b]};CardUI.prototype.isCardVisible=function(b){return this.menu[b].uiLastDrawNum==this.drawNum};CardUI.prototype.getChilds=function(b){for(var c=[],d=0;d<this.menu.length;d++)void 0!=this.menu[d]&&this.menu[d].parentId==b&&(c[c.length]=this.menu[d]);return c};
CardUI.prototype.onItemClick=function(b){"function"===typeof this.menu[b].onClick&&this.menu[b].onClick.call(this.menu[b]);if(!0!==this.menu[b].preventDefaultClickAction){var c=0;b==this.curItem?(c=this.parent(b),"function"===typeof this.menu[b].onToggleOff&&this.menu[b].onToggleOff.call(this.menu[b])):b==this.parent(this.curItem)?(c=this.parent(this.parent(this.curItem)),"function"===typeof this.menu[b].onToggleOff&&this.menu[b].onToggleOff.call(this.menu[b])):(c=b,"function"===typeof this.menu[b].onToggleOn&&
this.menu[b].onToggleOn.call(this.menu[b]));this.setCurItem(c);this.draw()}"function"===typeof this.menu[b].afterClick&&this.menu[b].afterClick.call(this.menu[b])};CardUI.prototype.setCurItem=function(b){if(void 0!=b&&null!=b){var c=this.menu[this.curItem].level,d=this.menu[b].level;this.curItem=b;this.selectedItem=null;this.nextDrawDirection=d>c?1:d<c?-1:0;"function"===typeof this.menu[b].onSetToCur&&this.menu[b].onSetToCur.call(this.menu[b])}};
CardUI.prototype.showSimpleDialog=function(b,c){this.init();b.dialog=!0;b.clickable=!1;b.closeButton=!0;b.onClose=function(b){b.ui.setVisible(!1);"function"==typeof c&&c(b)};this.removeAllChilds(0);this.addCard(0,b);this.draw()};CardUI.prototype.draw=function(){1==this.nextDrawDirection&&this.cols[2].hide();this.doDraw();1==this.nextDrawDirection&&this.cols[2].fadeIn(this.fadeTime);this.nextDrawDirection=void 0};
CardUI.prototype.contentAppend=function(b,c){0<b.children().length&&b.append("<div class='CardUI-separator'></div>");b.append(c)};
CardUI.prototype.doDraw=function(){if(this.visible){this.drawNum++;for(var b=-2;0>=b;b++){this.cols[b+2].empty();var c=this.menu[this.curItem].level+b;if(0>c)$(this.rootId+" div.CardUI-column").eq(b+2).hide();else{$(this.rootId+" div.CardUI-column").eq(b+2).show();var d,e=null;c==this.menu[this.curItem].level-2?(d=this.getChilds(this.parent(this.parent(this.curItem))),e=this.parent(this.curItem)):c==this.menu[this.curItem].level-1?(d=this.getChilds(this.parent(this.curItem)),e=this.curItem):c==this.menu[this.curItem].level&&
(d=this.getChilds(this.curItem));for(c=0;c<d.length;c++)if(!1!==d[c].visible&&!0!==d[c].isRow){var f=d[c];f.uiLastDrawNum=this.drawNum;var g=$(document.createElement("div"));g.attr("id","UICard-"+f.id);g.addClass("CardUI-card");g.data("id",f.id);e==f.id&&g.addClass("CardUI-selectedItem");this.drawCard(f.id,g,!0);this.cols[b+2].append(g)}this.refreshPositions()}}}};
CardUI.prototype.refreshPositions=function(){var b=this;setTimeout(function(){var c=$(b.rootId+" div.CardUI-column:nth-child(1)"),d=$(b.rootId+" div.CardUI-column:nth-child(2)"),e=$(b.rootId+" div.CardUI-column:nth-child(3)");c.css("left",0);d.css("left",c.width());e.css("left",d.width()+(c.is(":visible")?c.width():0));c.css("top",Math.max(0,$(window).height()/2-c.height()/2));d.css("top",Math.max(0,$(window).height()/2-d.height()/2));e.css("top",Math.max(0,$(window).height()/2-e.height()/2))},0)};
CardUI.prototype.drawCard=function(b,c,d){var e=null;void 0===c&&(c=$("#UICard-"+b));1>c.length&&console.log("Could not find div from id "+b);b=this.menu[b];c.empty();isNaN(b.maxWidth)||c.css("max-width",b.maxWidth+"px");if(!1!==b.clickable){c.addClass("CardUI-clickable");var f=this;c.click(function(b){if("BUTTON"!=b.target.nodeName&&"INPUT"!=b.target.nodeName&&"A"!=b.target.nodeName)f.onItemClick($(this).data("id"))})}if(b.title){var g=$("<div class='CardUI-card-title'></div>");g.append(b.title);
this.contentAppend(c,g)}$.isArray(b.content)&&void 0!==b.tabs||!b.content||(g=$("<div class='CardUI-card-content'></div>"),g.append(b.content),this.contentAppend(c,g));if("object"==typeof b.table){var g=$("<table class='CardUI-card-table'><thead></thead><tbody></tbody></table>"),h=0;if("object"==typeof b.table.columns)for(col in b.table.columns)g.find("thead").append("<th>"+b.table.columns[col]+"</th>"),h++;else"number"===typeof b.table.columns&&(h=b.table.columns);var l;if("object"==typeof b.table.rows)for(var n=
0;n<b.table.rows.length;n++){l=$("<tr></tr>");!0===b.table.selectable&&(l.addClass("selectable"),n==b.table.selectedIdx&&l.addClass("selected"),l.data("cardId",b.id),l.data("ui-idx",n),f=this,l.click(function(b){var c=$(this).data("cardId");b=$(this).data("ui-idx");c=f.get(c);c.table.selectedIdx=c.table.selectedIdx==b?void 0:b;"function"===typeof c.table.onClick&&c.table.onClick.call(c,c.table.rows[b],b);"function"===typeof c.table.onSelect&&c.table.selectedIdx==b&&c.table.onSelect.call(c,c.table.rows[b],
b);"function"===typeof c.table.onDeselect&&void 0===c.table.selectedIdx&&c.table.onDeselect.call(c,c.table.rows[b],b);f.draw()}));for(var m=0;m<h;m++)if("object"!=typeof b.table.columns[m]||!1!==b.table.columns[m].visible)$.isArray(b.table.rows[n])||void 0===b.table.rows[n].cells||void 0===b.table.rows[n].cells[m]?"object"===typeof b.table.rows[n][m]&&void 0!==b.table.rows[n][m].text?$("<td></td>").appendTo(l).append(b.table.rows[n][m].text):$("<td></td>").appendTo(l).append(b.table.rows[n][m]):$("<td></td>").appendTo(l).append(b.table.rows[n].cells[m]);
g.find("tbody").append(l)}this.contentAppend(c,g)}if(b.inputs&&0<b.inputs.length){g=$("<table class='CardUI-inputtable'></table>");for(h=0;h<b.inputs.length;h++)m="input"+b.id+"-"+h,l=$(document.createElement("tr")),l.append("<td>"+(b.inputs[h].label?b.inputs[h].label:"")+"</td>"),n=$(document.createElement("input")),n.addClass("CardUI-card"),n.attr("type",b.inputs[h].type),n.attr("id",m),n.data("id",b.id),n.data("inputIdx",h),void 0!==b.inputs[h].value&&n.val(b.inputs[h].value),m=$(document.createElement("td")),
m.append(n),l.append(m),g.append(l),null===e&&(e=n);this.contentAppend(c,g)}if(b.buttons&&0<b.buttons.length){g=$("<div class='NewUI-CardButtonGroup'></div>");for(h=0;h<b.buttons.length;h++)l=$(document.createElement("button")),l.addClass("CardUI-clickable"),l.addClass("CardUI-card"),l.html(b.buttons[h].title),l.data("cardId",b.id),l.data("buttonIdx",h),f=this,l.click(function(b){b=f.menu[$(this).data("cardId")];var c=b.buttons[$(this).data("buttonIdx")];f.handleButtonClick(b,c)}),g.append(l),null===
e&&(e=l);this.contentAppend(c,g)}!0===b.closeButton&&(l=$(document.createElement("div")),l.addClass("CardUI-closeButton"),l.data("cardId",b.id),l.data("type","close"),f=this,l.click(function(b){b=f.menu[$(this).data("cardId")];f.setCurItem(f.parent(b.parentId));if("function"===typeof b.onClose)b.onClose(b);f.draw()}),c.prepend(l));b.maximize&&c.addClass("CardUI-maximized-card");b.dialog?(c.addClass("CardUI-dialog-card"),1>$(this.rootId+" div.overlay").length&&$(this.rootId).append("<div class='overlay' onclick=\"$('"+
this.rootId+" div.CardUI-dialog-card .CardUI-closeButton').click();\"></div<"),isNaN(b.width)||c.css("width",b.width),isNaN(b.height)||c.css("height",b.height),c.hide(),f=this,setTimeout(function(){var b=$("div.CardUI-dialog-card");b.data("cardId");b.css("left",$(window).width()/2-b.width()/2);b.css("top",$(window).height()/2-b.height()/2);$(f.rootId+" div.overlay").fadeIn("fast");c.show()},0)):$(this.rootId+" div.overlay").fadeOut("fast");!0!==d&&this.refreshPositions();null!==e&&setTimeout(function(){e.focus()},
0)};
CardUI.prototype.handleButtonClick=function(b,c){if(b.inputs)for(var d=[],e=0;e<b.inputs.length;e++)d[e]="checkbox"==b.inputs[e].type?$("#input"+b.id+"-"+e).attr("checked")?!0:!1:$("#input"+b.id+"-"+e).val();isNaN(c["goto"])||(this.setCurItem(c["goto"]),this.draw());!0===c.close&&(this.setCurItem(this.parent(b.parentId)),"function"===typeof b.onClose&&b.onClose.call(b),this.draw());isNaN(c.show)||(this.setChildsVisibility(this.parent(c.show),!1),this.setCardVisibility(c.show,!0),this.setCurItem(this.parent(c.show)),this.draw());
isNaN(c.showToggle)||(this.isCardVisible(c.showToggle)?(this.setCardVisibility(c.showToggle,!1),this.setCurItem(this.parent(this.parent(c.showToggle)))):(this.setChildsVisibility(this.parent(c.showToggle),!1),this.setCardVisibility(c.showToggle,!0),this.setCurItem(this.parent(c.showToggle))),this.draw());"function"===typeof c.onClick&&c.onClick.call(b,c,d)};
function Card(b,c){this.ui=c;for(k in b)this[k]=b[k];this.addChild=function(b){return this.ui.addCard(this.id,b)};this.removeAllChilds=function(){return this.ui.removeAllChilds(this.id)};this.removeCardByIdx=function(b){return this.ui.removeCardByIdx(this.id,b)};this.removeCard=function(){return this.ui.removeCard(this.id)};this.isVisible=function(){return this.ui.isCardVisible(this.id)};this.getChilds=function(){return this.ui.getChilds(this.id)};this.parent=function(){return this.ui.get(this.parentId)};
this.setAsCurrent=function(){return this.ui.setCurItem(this.id)};this.draw=function(){return this.ui.drawCard(this.id)};this.eachChild=function(b){$.each(this.getChilds(),function(c,f){b.call(this,f,c)})}};function Comments(){this.type="Comments";this.options={};this.popup=this.element=null}Comments.prototype.init=function(b){this.options=b;"string"===typeof this.options.elementRef?this.element=$("#"+this.options.elementRef):"object"===typeof this.options.element&&(this.element=this.options.element);this.element||console.log("ERROR: No element for Comments options");this.element.addClass("cmt");return this};
Comments.prototype.show=function(){var b=this;b.element.empty();var c=$("<button/>",{"class":"cmtbutton cmtnew",html:"Ny",href:"#"});c.click(function(){b.writeComment(function(c){"function"===typeof b.options.onAdd&&b.options.onAdd.call(b,c,function(){b.show()})})});this.element.append(c);$.isArray(b.options.comments)?(this.comments=b.options.comments,b.appendComments()):"function"===typeof b.options.getComments&&b.options.getComments.call(b,function(c){b.comments=c;b.appendComments()})};
Comments.prototype.appendComments=function(){for(var b=this,c=0;c<this.comments.length;c++){var d=this.comments[c].userId?this.comments[c].userId:this.comments[c].UserId,e=this.comments[c].timestamp?this.comments[c].timestamp:this.comments[c].Timestamp,f=this.comments[c].comment?this.comments[c].comment:this.comments[c].Comment,g=void 0===b.options.myUserId||b.options.myUserId===d,h=$("<div/>",{"class":"cmtcommentcontainer"+(g?" mycomment":"")});h.data("comment",this.comments[c]);h.append($("<span/>",
{html:e,"class":"cmttimestamp"}));h.append($("<span/>",{html:d+":","class":"cmtuserid"}));h.append($("<span/>",{html:f,"class":"cmtcomment"}));g&&(h.click(function(){var c=$(this).data("comment");if(c){var d=c.comment||c.Comment;b.writeComment(function(g){g=$.extend({},d,{comment:g,Comment:g});"function"===typeof b.options.onEdit&&b.options.onEdit.call(b,c,g,function(){b.show()})},d)}}),d=$("<button/>",{"class":"cmtbuttonsmall cmtdelete",html:"Slet"}),d.data("comment",this.comments[c]),d.click(function(c){c=
$(this).data("comment");c=c.userId?c.userId:c.UserId;void 0!==b.options.myUserId&&b.options.myUserId!==c?(new Notifier).show("Man kan ikke slette andres kommentarer"):confirm("Er du sikker p\u00e5 at du vil slette denne kommentar?")&&"function"===typeof b.options.onDelete&&b.options.onDelete.call(b,$(this).data("comment"),function(){b.show()})}),h.append(d));this.element.append(h)}};
Comments.prototype.writeComment=function(b,c){var d=new PopupCreator;d.init({title:"Skriv kommentar",content:"<textarea style='width: 400px; height: 70px; display: block;'></textarea><button id='ok' style=''>Gem</button><button id='cancel'>Fortryd</button>",onShow:function(){var d=this;this.element.find("textarea").focus();void 0!==c&&this.element.find("textarea").val(c);this.element.find("textarea").keydown(function(b){13==b.which&&d.element.find("#ok").click()});this.element.find("#ok").click(function(){var c=
d.element.find("textarea").val();c&&(d.close(),b.call(d,c))});this.element.find("#cancel").click(function(){d.close()})}});d.show()};function DesktopCreator(){this.type="DesktopCreator";this.options={};this.element=null;this.isNested=!1}
DesktopCreator.prototype.init=function(b){this.options=b;var c=this;"string"===typeof this.options.elementRef?this.element=$("#"+this.options.elementRef):"object"===typeof this.options.elementRef?this.element=this.options.elementRef:(this.element=$("<div></div>"),$("body").append(this.element));this.isNested||$(document).keydown(function(b){if(!(0<$("input:focus,textarea:focus").length)){if(!b.altKey&&!b.ctrlKey&&!b.shiftKey&&(65<=b.keyCode&&90>=b.keyCode||48<=b.keyCode&&57>=b.keyCode||192==b.keyCode||
222==b.keyCode||221==b.keyCode||32==b.keyCode)){var e=String.fromCharCode(b.keyCode).toLowerCase();if($(".dcsearchbox").is(":visible")){var f=$(".dcsearchbox");f.is(":focus")||(f.val(f.val()+e),c.filter(f.val()))}else f=$("<input class='dcsearchbox' type='text'>"),f.on("change paste keyup",function(){c.filter($(".dcsearchbox").val())}),f.val(e),$("body").append(f),c.filter(e)}27!=b.keyCode||$(".dcsearchbox").is(":visible")||$(".pcpopup").is(":visible")||c.element.find("div.dcfolderexpandedd:visible").each(function(){$(this).data("desktop").shortcutClicked.call(this)});
27==b.keyCode&&$(".dcsearchbox").is(":visible")&&($(".dcsearchbox").remove(),c.filter());8==b.keyCode&&$(".dcsearchbox").is(":visible")&&(e=$(".dcsearchbox").val(),1<e.length?(e=0<e.length?e.substring(0,e.length-1):"",$(".dcsearchbox").val(e),c.filter(e)):($(".dcsearchbox").remove(),c.filter()));13==b.keyCode&&$(".dcsearchbox").is(":visible")?(b=c.element.find("div.dcshortcut:visible:not(.dcfolderexpandedd):first"),0<b.length&&(c.element.find("div.dcshortcut:visible:focus"),b.focus(),b.data("desktop").shortcutClicked.call(b),
$(".dcsearchbox").remove(),c.filter())):13!=b.keyCode||$(".dcsearchbox").is(":visible")||(b=c.element.find("div.dcshortcut:visible:not(.dcfolderexpandedd):focus"),0<b.length&&b.data("desktop").shortcutClicked.call(b))}});$(document).keydown(function(b){if(8===b.which&&1>$("input:focus").length&&1>$("textarea:focus").length)return!1})};
DesktopCreator.prototype.show=function(b){this.element.addClass("dcdesktop");this.element.empty();var c=this;this.options.desktopShortcuts=this.options.desktopShortcuts.sort(function(b,c){return b.title>c.title?1:-1});for(b=0;b<this.options.desktopShortcuts.length;b++){var d=this.options.desktopShortcuts[b];if(!1!==d.visible){"function"===typeof d.onBeforeShow&&d.onBeforeShow.call(this,d);var e=$("<div class='dcshortcut'></div>"),f=$("<img></img>");!0===d.isFolder&&void 0===d.icon?f.prop("src","/img/folder.png"):
void 0===d.icon?f.prop("src","/img/unknown.png"):f.prop("src",d.icon);f.prop("title",d.title);var g=$("<p></p>");g.html(d.title);e.append(f);e.append(g);e.data("shortcut",d);e.data("desktop",c);d.isFolder&&e.addClass("dcfolder");e.attr("tabindex",b+2);f.click(this.shortcutClicked);g.click(this.shortcutClicked);e.click(function(b){$(b.target).hasClass("dcshortcut")&&$(b.target).is($(this))&&c.shortcutClicked.call(this)});this.element.append(e)}}setTimeout(function(){var b=0;c.element.find(".dcshortcut").each(function(){b=
Math.max(b,$(this).height())});0<b&&c.element.find(".dcshortcut").height(b)},1)};DesktopCreator.prototype.runApp=function(b,c){this.element.find(".dcshortcut").each(function(){$(this).data("shortcut").id==b&&t.shortcutClicked.call($(this),c)})};
DesktopCreator.prototype.shortcutClicked=function(b){var c=$(this).hasClass("dcshortcut")?$(this):$(this).parent().hasClass("dcshortcut")?$(this).parent():$(this),d=c.data("shortcut"),e=c.data("desktop");void 0!==b&&(d=$.extend({},d,b));if(d.isFolder)if(c.hasClass("dcfolderexpandedd"))c.find("img").show(),c.find(".dcfoldercontent").remove(),c.removeClass("dcfolderexpandedd");else{c.removeAttr("tabindex");c.find("img").hide();b=$("<div class='dcfoldercontent'></div>");var f=new DesktopCreator;f.isNested=
!0;f.init({elementRef:b,desktopShortcuts:d.content});f.show();c.addClass("dcfolderexpandedd");c.append(b);e.element.find("div.dcshortcut:visible:focus");c.find(".dcshortcut:first").focus()}else"function"===typeof d.onClick&&d.onClick.call(d),void 0!==d.popup&&(c=new PopupCreator,b=jQuery.extend(!0,{desktop:e,desktopShortcut:d},d.popup),void 0!==d.icon&&void 0===b.icon&&(b.icon=d.icon),c.init(b),c.show()),void 0!==d.gotoURL&&(window.location=d.gotoURL);e.filter.call(e)};
DesktopCreator.prototype.filter=function(b){var c=2;this.element.find("div.dcshortcut").each(function(){$(this).hasClass("dcfolderexpandedd")?$(this).removeAttr("tabindex"):$(this).attr("tabindex",c);c++;!(void 0!==b&&""!==b&&0>$(this).data("shortcut").title.toLowerCase().indexOf(b.toLowerCase()))||$(this).data("shortcut").isFolder&&$(this).hasClass("dcfolderexpandedd")?$(this).show():$(this).hide()})};function FieldEdit(b){this.type="FieldEdit";this.options={};this.popup=this.saveBtn=this.valueElement=this.element=null;this.language=b?b:"en";this.translations={da:{save:"Gem"},en:{save:"Save"}}}
FieldEdit.prototype.init=function(b){this.options=b;var c=this;"string"===typeof this.options.elementRef?this.element=$("#"+this.options.elementRef):"object"===typeof this.options.element&&(this.element=this.options.element);this.element||console.log("ERROR: No element for FieldEdit options");this.element.addClass("fe");this.element.addClass("feedit");this.element.data("fe",this);"function"===typeof this.options.values&&this.options.values.call(this,function(b){c.options.values=b});return this};
FieldEdit.prototype.attach=function(){var b=this;this.element.mouseenter(function(){b.valueChanged()&&b.valueElement||(clearTimeout(b.mouseOutTimer),$(".feedit .fevalueelement").is(":focus")||b.show())});this.element.click(function(){clearTimeout(b.mouseOutTimer);$(".feedit .fevalueelement").is(":focus")||b.show()});this.element.empty();void 0!==this.options.valueDisplay?this.element.append(this.options.valueDisplay?this.options.valueDisplay:"&nbsp;"):this.element.append(this.options.value?this.options.value:
"&nbsp;")};
FieldEdit.prototype.show=function(b){var c=this.element.width(),d=this.element.height(),e=this,f=null,f="function"===typeof this.options.valueSource?this.options.valueSource.call(this):this.options.value;switch(this.options.type){case "text":this.valueElement=$("<textarea/>",{"class":"fevalueelement",val:f,rows:1});break;case "textarea":this.valueElement=$("<textarea/>",{"class":"fevalueelement",val:f});this.valueElement.on("input",function(){var b=$(this).height(),c=$(this).val().split("\n").length;b<
20*c&&$(this).height(20*c);e.saveBtn.css("top",$(this).height())});break;case "checkbox":this.valueElement=$("<input/>",{"class":"fevalueelement",type:"checkbox",checked:f});break;case "taglist":this.valueElement=$("<span/>",{"class":"fevalueelement fetaglist"});if("string"===typeof e.options.value)for(var f=e.options.value.split(","),g=0;g<f.length;g++){var h=$("<span/>",{html:$.trim(f[g])}),l=$("<img/>",{src:"/img/close.png"});l.data("tag",$.trim(f[g]));l.click(function(b){b=$(this).data("tag");
"function"===typeof e.options.onTagRemove&&e.options.onTagRemove.call(e,b,e.element)});h.append(l);this.valueElement.append(h)}g=$("<img/>",{src:"/img/add.png","class":"fetaglistnew"});g.click(function(b){$(this).data("tag");e.hide();"function"===typeof e.options.onTagAdd&&e.options.onTagAdd.call(e,e.element)});this.valueElement.append(g);break;case "select":this.valueElement=$("<select/>",{"class":"fevalueelement"});for(g in e.options.values)"object"===typeof e.options.values[g]?this.valueElement.append("<option value='"+
(void 0!==e.options.values[g].Id?e.options.values[g].Id:e.options.values[g].id)+"'>"+(void 0!==e.options.values[g].Label?e.options.values[g].Label:e.options.values[g].label)+"</option>"):this.valueElement.append("<option value='"+g+"'>"+e.options.values[g]+"</option>");this.valueElement.val(f);break;default:console.log("Unknown type: "+this.options.type);return}isNaN(e.options.maxLength)||this.valueElement.attr("maxlength",e.options.maxLength);this.element.empty();this.element.append(this.valueElement);
this.element.mouseleave(function(){null===e.element||e.valueElement.is(":focus")||e.valueChanged()||e.hide()});this.element.focusout(function(){e.valueChanged()||(e.saveBtn.hide(),null===e.element||e.element.is(":focus")||e.hide())});this.element.focusin(function(){e.saveBtn.show()});this.element.keydown(function(b){var c=b.keyCode||b.which;if(13==c)"text"==e.options.type&&(b.stopPropagation(),e.save());else if(27==c)b.stopPropagation(),e.hide();else if(9==c){b.preventDefault();var d=!1,c=void 0!==
e.options.rootElement?e.options.rootElement:0<e.element.closest(".pccontent").length?e.element.closest(".pccontent"):e.element.parent();(b.shiftKey?$(c.find(".fe").get().reverse()):c.find(".fe")).each(function(){if(d){var b=$(this).data("fe");if("taglist"!==b.options.type)return b.show(!0),!1}$(this)[0]==e.element[0]&&(d=!0)})}return!0});0<this.element.height()&&this.valueElement.height(0<d?d:"1em");!0===this.options.sameWidth?this.valueElement.width(c):void 0!==this.options.width&&this.valueElement.width(this.options.width);
this.valueElement.css({"font-family":this.element.css("font-family"),"font-size":this.element.css("font-size"),"font-style":this.element.css("font-style"),"font-variant":this.element.css("font-variant"),"font-weight":this.element.css("font-weight")});this.saveBtn=$("<button/>",{"class":"fesave febuttonsmall",html:this.label("save")});this.saveBtn.mousedown(function(){e.save()});this.saveBtn.css("top",this.element.height());this.saveBtn.hide();this.element.append(this.saveBtn);b&&this.valueElement.focus()};
FieldEdit.prototype.valueChanged=function(){var b=this.getValue(),c=this.options.value;return b==c||!b&&!c||"taglist"==this.options.type?!1:!0};FieldEdit.prototype.getValue=function(){var b=null;this.valueElement&&(b="checkbox"===this.options.type?this.valueElement.is(":checked"):this.valueElement.val());return b};
FieldEdit.prototype.save=function(){var b=this.getValue();"function"===typeof this.options.onSave&&this.options.onSave.call(this,b,this.options.value,this.element);this.options.value=b;this.hide()};FieldEdit.prototype.setValue=function(b){this.options.value=b;this.hide()};
FieldEdit.prototype.hide=function(){null!==this.element&&(this.element.empty(),this.element.off("focusin"),this.element.off("focusout"),this.element.off("mouseleave"),this.element.off("keydown"),void 0!==this.options.valueDisplay?this.element.append(this.options.valueDisplay?this.options.valueDisplay:"&nbsp;"):this.element.append(this.options.value&&null!==this.options.value?this.options.value:"&nbsp;"))};FieldEdit.prototype.label=function(b){return this.translations[this.language][b]};var _FrameworkSessionId,_FrameworkRequestFixedArgs={};
function request(b,c,d){void 0===_FrameworkSessionId&&("undefined"!==typeof Storage&&(_FrameworkSessionId=localStorage.getItem("SessionId")),null==_FrameworkSessionId&&void 0!==$.cookie&&(_FrameworkSessionId=$.cookie("SessionId")),_FrameworkSessionId||(_FrameworkSessionId=guid()),void 0!==$.cookie&&$.cookie("SessionId",_FrameworkSessionId,{expires:30,path:"/"}),"undefined"!==typeof Storage&&localStorage.setItem("SessionId",_FrameworkSessionId));var e={},f;for(f in _FrameworkRequestFixedArgs)e[f]=
_FrameworkRequestFixedArgs[f];jQuery.extend(!0,e,{sessionId:_FrameworkSessionId},b);$.ajax({url:"/request",type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(b){void 0!==b.error?(console.log(b),"function"===typeof d&&d(b),$(document).trigger("request_error",b)):"function"===typeof c&&c(b)},error:function(b){"function"===typeof d&&d({type:"connection",message:b})}})}
function requestLink(b){var c="/request?",d={},e;for(e in _FrameworkRequestFixedArgs)d[e]=_FrameworkRequestFixedArgs[e];jQuery.extend(!0,{},d,{sessionId:_FrameworkSessionId},b);for(i in d)c+=i+"="+d[i];return c}function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function guid(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}
window.isMobile=function(){var b=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))b=!0;return b};function getUrlVar(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");b=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(window.location.href);return null==b?void 0:decodeURIComponent(b[1])}"ontouchstart"in document.documentElement||(document.documentElement.className+=" no-touch");function GraphCoord(b,c,d){this.x=b;this.y=c;this.text=d}
function GraphDrawer(){this.vlines=!1;this.hlines=!0;this.xLabelSpacing=40;this.drawZeroOnX=!0;this.draw=function(b,c,d,e){var f=d-30;b.beginPath();b.lineWidth=2;b.moveTo(30,f);b.lineTo(30,30);b.lineTo(35,40);b.moveTo(30,30);b.lineTo(25,40);b.moveTo(30,f);b.lineTo(c-30,f);b.lineTo(c-40,f-5);b.moveTo(c-30,f);b.lineTo(c-40,f+5);b.moveTo(30,f);b.stroke();b.beginPath();b.lineWidth=1;for(var g=(c-60)/e.length,h=0,l=Number.MAX_VALUE,n=0;n<e.length;n++)h=e[n].y>h?e[n].y:h,l=e[n].y<l?e[n].y:l;b.textAlign=
"right";yTextSpacing=20;iVal=yTextSpacing/(f-30);for(n=f;30<n;n-=yTextSpacing)b.fillText(Math.floor((f-n)/(f-30)*(h-l)+l),25,n),this.hlines&&(b.moveTo(30,n),b.lineTo(c-40,n));b.stroke();b.beginPath();b.strokeStyle="#0000ff";b.lineWidth=2;lastText=30;b.moveTo(30,f-e[0].y/h*(d-80));b.textAlign="center";!0!==this.drawZeroOnX&&void 0!=e&&0<e.length?b.fillText(void 0!=e[0].text?e[0].text:e[0].x,30,f+15):b.fillText(0,30,f+15);for(n=1;n<e.length;n++){c=parseInt(30+n*g);var m=parseInt(f-(e[n].y-l)/(h-l)*
(d-80));b.lineTo(c,m);c>lastText+this.xLabelSpacing&&(b.fillText(void 0!=e[n].text?e[n].text:e[n].x,c,f+15),lastText=c,this.vlines&&(b.stroke(),b.beginPath(),b.strokeStyle="black",b.lineWidth=1,b.moveTo(c,f),b.lineTo(c,40),b.stroke(),b.beginPath(),b.strokeStyle="#0000ff",b.lineWidth=2,b.moveTo(c,m)))}b.stroke()}};function ImageViewer(){this.imagelist=[];this.element=null;this.curIdx=-1}ImageViewer.prototype.init=function(b){var c=this;b=$.extend(!0,[],b);this.imagelist=$.isArray(b)?b:[b];for(b=0;b<this.imagelist.length;b++)this.imagelist[b].id=guid();$(document).keydown(function(b){27==b.keyCode?c.close():37==b.keyCode?c.prev():39==b.keyCode&&c.next()})};
ImageViewer.prototype.show=function(b){var c=this;b=parseInt(b);null==this.element&&(this.element=$("<div class='ImageViewer'></div>"),$("body").append(this.element),this.element.click(".imageviewer",function(b){b.clientX<$(window).innerWidth()/3?c.prev():b.clientX>$(window).innerWidth()*(2/3)?c.next():c.close()}));this.element.empty();this.curIdx=void 0===b?0:b;$.isArray(this.imagelist)&&this.curIdx<this.imagelist.length&&(b=$("<img></img>",{src:"/img/loading2.gif"}),this.element.append(b),this.loadAdjacentImages(this.curIdx))};
ImageViewer.prototype.next=function(){this.curIdx+1<this.imagelist.length&&this.show(this.curIdx+1)};ImageViewer.prototype.prev=function(){0<=this.curIdx-1&&this.show(this.curIdx-1)};ImageViewer.prototype.close=function(b){null!=this.element&&this.element.remove()};
ImageViewer.prototype.loadAdjacentImages=function(b){var c=this;b=parseInt(b);var d=function(){c.element.removeClass("imgloading");c.imagelist[c.curIdx].id==$(this).data("id")&&(c.element.find("img")[0].src=this.src);for(var b=0;b<c.imagelist.length;b++)c.imagelist[b].id==$(this).data("id")&&(c.imagelist[b].image=this)},e=[b,b+1,b-1,b+2];b=[];for(var f=0;f<e.length;f++)0<=e[f]&&e[f]<this.imagelist.length&&b.push(e[f]);console.log(b);for(f=0;f<b.length;f++)void 0!==this.imagelist[b[f]].image?b[f]==
this.curIdx&&(c.element.find("img")[0].src=this.imagelist[b[f]].image.src):(e=new Image,e.onload=d,e.src=this.imagelist[b[f]].src,this.imagelist[b[f]].src=e.src,$(e).data("id",this.imagelist[b[f]].id),b[f]==this.curIdx&&this.element.addClass("imgloading"))};function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function guid(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()};(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b(jQuery)})(function(b){function c(b){return b}function d(b){return decodeURIComponent(b.replace(f," "))}function e(b){0===b.indexOf('"')&&(b=b.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return g.json?JSON.parse(b):b}catch(c){}}var f=/\+/g,g=b.cookie=function(f,l,n){if(void 0!==l){n=b.extend({},g.defaults,n);if("number"===typeof n.expires){var m=n.expires,w=n.expires=new Date;w.setDate(w.getDate()+m)}l=g.json?
JSON.stringify(l):String(l);return document.cookie=[g.raw?f:encodeURIComponent(f),"=",g.raw?l:encodeURIComponent(l),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}l=g.raw?c:d;n=document.cookie.split("; ");for(var m=f?void 0:{},w=0,v=n.length;w<v;w++){var z=n[w].split("="),y=l(z.shift()),z=l(z.join("="));if(f&&f===y){m=e(z);break}f||(m[y]=e(z))}return m};g.defaults={};b.removeCookie=function(c,d){return void 0!==
b.cookie(c)?(b.cookie(c,"",b.extend(d,{expires:-1})),!0):!1}});(function(b){function c(){this.removeEventListener("touchmove",d);this.removeEventListener("touchend",c);h=!1}function d(d){b.detectSwipe.preventDefault&&d.preventDefault();if(h){var e=f-d.touches[0].pageX;d=g-d.touches[0].pageY;var m;Math.abs(e)>=b.detectSwipe.threshold?m=0<e?"left":"right":Math.abs(d)>=b.detectSwipe.threshold&&(m=0<d?"down":"up");m&&(c.call(this),b(this).trigger("swipe",m).trigger("swipe"+m))}}function e(b){1==b.touches.length&&(f=b.touches[0].pageX,g=b.touches[0].pageY,h=!0,this.addEventListener("touchmove",
d,!1),this.addEventListener("touchend",c,!1))}b.detectSwipe={version:"2.1.1",enabled:"ontouchstart"in document.documentElement,preventDefault:!0,threshold:20};var f,g,h=!1;b.event.special.swipe={setup:function(){this.addEventListener("touchstart",e,!1)}};b.each(["left","up","down","right"],function(){b.event.special["swipe"+this]={setup:function(){b(this).on("swipe",b.noop)}}})})(jQuery);/*
 MIT License - http://www.opensource.org/licenses/mit-license.php

 For usage and examples, check out the README at:
 http://github.com/vaidik/jquery-longpress/

 Copyright (c) 2008-2013, Vaidik Kapoor (kapoor [*dot*] vaidik -[at]- gmail [*dot*] com)
*/
(function(b){b.fn.longpress=function(c,d,e){"undefined"===typeof e&&(e=500);return this.each(function(){function f(d){n=(new Date).getTime();var g=b(this);m=setTimeout(function(){"function"===typeof c?c.call(g,d):b.error("Callback required for long press. You provided: "+typeof c)},e)}function g(c){(new Date).getTime()-n<e&&(clearTimeout(m),"function"===typeof d?d.call(b(this),c):"undefined"!==typeof d&&b.error("Optional callback for short press should be a function."))}function h(b){clearTimeout(m)}
var l=b(this),n,m;l.on("mousedown",f);l.on("mouseup",g);l.on("mousemove",h);l.on("touchstart",f);l.on("touchend",g);l.on("touchmove",h)})}})(jQuery);(function(b){"function"===typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],b):b(jQuery)})(function(b){function c(c){!c||void 0!==c.allowPageScroll||void 0===c.swipe&&void 0===c.swipeStatus||(c.allowPageScroll="none");void 0!==c.click&&void 0===c.tap&&(c.tap=c.click);c||(c={});c=b.extend({},b.fn.swipe.defaults,c);return this.each(function(){var g=b(this),e=g.data("TouchSwipe");e||(e=new d(this,c),g.data("TouchSwipe",e))})}function d(c,d){function h(c){if(!0!==x.data("TouchSwipe_intouch")&&
!(0<b(c.target).closest(d.excludedElements,x).length)){var f=c.originalEvent?c.originalEvent:c,h,l=e?f.touches[0]:f;A="start";e?B=f.touches.length:c.preventDefault();F=0;T=H=null;aa=Z=D=0;P=1;U=0;c=[];for(var m=0;5>=m;m++)c.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});I=c;c={};c.left=S("left");c.right=S("right");c.up=S("up");c.down=S("down");fa=c;ga=da=0;if(!e||B===d.fingers||"all"===d.fingers||K()){if(V(0,l),ha=M(),2==B&&(V(1,f.touches[1]),Z=aa=W(I[0].start,I[1].start)),d.swipeStatus||d.pinchStatus)h=
y(f,A)}else h=!1;if(!1===h)return A="cancel",y(f,A),h;R(!0);return null}}function l(c){var f,h,l,m=c.originalEvent?c.originalEvent:c;if("end"!==A&&"cancel"!==A&&!Q()){var n,p=X(e?m.touches[0]:m);ea=M();e&&(B=m.touches.length);A="move";2==B&&(0==Z?(V(1,m.touches[1]),Z=aa=W(I[0].start,I[1].start)):(X(m.touches[1]),aa=W(I[0].end,I[1].end),T=1>P?"out":"in"),P=(aa/Z*1).toFixed(2),U=Math.abs(Z-aa));if(B===d.fingers||"all"===d.fingers||!e||K()){f=p.start;h=p.end;f=Math.atan2(h.y-f.y,f.x-h.x);f=Math.round(180*
f/Math.PI);0>f&&(f=360-Math.abs(f));f=H=45>=f&&0<=f?"left":360>=f&&315<=f?"left":135<=f&&225>=f?"right":45<f&&135>f?"down":"up";if("none"===d.allowPageScroll||K())c.preventDefault();else switch(h="auto"===d.allowPageScroll,f){case "left":(d.swipeLeft&&h||!h&&"horizontal"!=d.allowPageScroll)&&c.preventDefault();break;case "right":(d.swipeRight&&h||!h&&"horizontal"!=d.allowPageScroll)&&c.preventDefault();break;case "up":(d.swipeUp&&h||!h&&"vertical"!=d.allowPageScroll)&&c.preventDefault();break;case "down":(d.swipeDown&&
h||!h&&"vertical"!=d.allowPageScroll)&&c.preventDefault()}c=p.start;f=p.end;F=Math.round(Math.sqrt(Math.pow(f.x-c.x,2)+Math.pow(f.y-c.y,2)));D=ea-ha;c=H;f=F;f=Math.max(f,Y(c));fa[c].distance=f;if(d.swipeStatus||d.pinchStatus)n=y(m,A);if(!d.triggerOnTouchEnd||d.triggerOnTouchLeave){c=!0;if(d.triggerOnTouchLeave){l=b(this);var q=l.offset();c=q.left;f=q.left+l.outerWidth();h=q.top;l=q.top+l.outerHeight();p=p.end;c=p.x>c&&p.x<f&&p.y>h&&p.y<l}!d.triggerOnTouchEnd&&c?A=z("move"):d.triggerOnTouchLeave&&
!c&&(A=z("end"));"cancel"!=A&&"end"!=A||y(m,A)}}else A="cancel",y(m,A);!1===n&&(A="cancel",y(m,A))}}function n(b){var c=b.originalEvent;if(e&&0<c.touches.length)return da=M(),ga=event.touches.length+1,!0;Q()&&(B=ga);b.preventDefault();ea=M();D=ea-ha;J()?(A="cancel",y(c,A)):d.triggerOnTouchEnd||0==d.triggerOnTouchEnd&&"move"===A?(A="end",y(c,A)):!d.triggerOnTouchEnd&&d.tap?(A="end",E(c,A,"tap")):"move"===A&&(A="cancel",y(c,A));R(!1);return null}function m(){aa=Z=ha=ea=B=0;P=1;ga=da=0;R(!1)}function w(b){b=
b.originalEvent;d.triggerOnTouchLeave&&(A=z("end"),y(b,A))}function v(){x.unbind(q,h);x.unbind("touchcancel",m);x.unbind(r,l);x.unbind(u,n);ca&&x.unbind(ca,w);R(!1)}function z(b){var c=b,e=d.maxTimeThreshold?D>=d.maxTimeThreshold?!1:!0:!0,f=L(),h=J();!e||h?c="cancel":!f||"move"!=b||d.triggerOnTouchEnd&&!d.triggerOnTouchLeave?!f&&"end"==b&&d.triggerOnTouchLeave&&(c="cancel"):c="end";return c}function y(b,c){var f=void 0;N()&&O()||O()?f=E(b,c,"swipe"):(G()&&K()||K())&&!1!==f&&(f=E(b,c,"pinch"));C()&&
d.doubleTap&&!1!==f?f=E(b,c,"doubletap"):D>d.longTapThreshold&&10>F&&d.longTap&&!1!==f?f=E(b,c,"longtap"):!(1!==B&&e||!isNaN(F)&&0!==F)&&d.tap&&!1!==f&&(f=E(b,c,"tap"));"cancel"===c&&m(b);"end"===c&&(e?0==b.touches.length&&m(b):m(b));return f}function E(c,f,e){var h=void 0;if("swipe"==e){x.trigger("swipeStatus",[f,H||null,F||0,D||0,B]);if(d.swipeStatus&&(h=d.swipeStatus.call(x,c,f,H||null,F||0,D||0,B),!1===h))return!1;if("end"==f&&N()){x.trigger("swipe",[H,F,D,B]);if(d.swipe&&(h=d.swipe.call(x,c,
H,F,D,B),!1===h))return!1;switch(H){case "left":x.trigger("swipeLeft",[H,F,D,B]);d.swipeLeft&&(h=d.swipeLeft.call(x,c,H,F,D,B));break;case "right":x.trigger("swipeRight",[H,F,D,B]);d.swipeRight&&(h=d.swipeRight.call(x,c,H,F,D,B));break;case "up":x.trigger("swipeUp",[H,F,D,B]);d.swipeUp&&(h=d.swipeUp.call(x,c,H,F,D,B));break;case "down":x.trigger("swipeDown",[H,F,D,B]),d.swipeDown&&(h=d.swipeDown.call(x,c,H,F,D,B))}}}if("pinch"==e){x.trigger("pinchStatus",[f,T||null,U||0,D||0,B,P]);if(d.pinchStatus&&
(h=d.pinchStatus.call(x,c,f,T||null,U||0,D||0,B,P),!1===h))return!1;if("end"==f&&G())switch(T){case "in":x.trigger("pinchIn",[T||null,U||0,D||0,B,P]);d.pinchIn&&(h=d.pinchIn.call(x,c,T||null,U||0,D||0,B,P));break;case "out":x.trigger("pinchOut",[T||null,U||0,D||0,B,P]),d.pinchOut&&(h=d.pinchOut.call(x,c,T||null,U||0,D||0,B,P))}}if("tap"==e){if("cancel"===f||"end"===f)clearTimeout(ia),d.doubleTap&&!C()?(ba=M(),ia=setTimeout(b.proxy(function(){ba=null;x.trigger("tap",[c.target]);d.tap&&(h=d.tap.call(x,
c,c.target))},this),d.doubleTapThreshold)):(ba=null,x.trigger("tap",[c.target]),d.tap&&(h=d.tap.call(x,c,c.target)))}else if("doubletap"==e){if("cancel"===f||"end"===f)clearTimeout(ia),ba=null,x.trigger("doubletap",[c.target]),d.doubleTap&&(h=d.doubleTap.call(x,c,c.target))}else"longtap"!=e||"cancel"!==f&&"end"!==f||(clearTimeout(ia),ba=null,x.trigger("longtap",[c.target]),d.longTap&&(h=d.longTap.call(x,c,c.target)));return h}function L(){var b=!0;null!==d.threshold&&(b=F>=d.threshold);return b}function J(){var b=
!1;null!==d.cancelThreshold&&null!==H&&(b=Y(H)-F>=d.cancelThreshold);return b}function G(){var b=B===d.fingers||"all"===d.fingers||!e,c=0!==I[0].end.x,f;f=null!==d.pinchThreshold?U>=d.pinchThreshold:!0;return b&&c&&f}function K(){return!!(d.pinchStatus||d.pinchIn||d.pinchOut)}function N(){var b=d.maxTimeThreshold?D>=d.maxTimeThreshold?!1:!0:!0,c=L(),f=B===d.fingers||"all"===d.fingers||!e,h=0!==I[0].end.x;return!J()&&h&&f&&c&&b}function O(){return!!(d.swipe||d.swipeStatus||d.swipeLeft||d.swipeRight||
d.swipeUp||d.swipeDown)}function C(){if(null==ba)return!1;var b=M();return!!d.doubleTap&&b-ba<=d.doubleTapThreshold}function Q(){var b=!1;da&&M()-da<=d.fingerReleaseThreshold&&(b=!0);return b}function R(b){!0===b?(x.bind(r,l),x.bind(u,n),ca&&x.bind(ca,w)):(x.unbind(r,l,!1),x.unbind(u,n,!1),ca&&x.unbind(ca,w,!1));x.data("TouchSwipe_intouch",!0===b)}function V(b,c){I[b].identifier=void 0!==c.identifier?c.identifier:0;I[b].start.x=I[b].end.x=c.pageX||c.clientX;I[b].start.y=I[b].end.y=c.pageY||c.clientY;
return I[b]}function X(b){var c=void 0!==b.identifier?b.identifier:0;a:{for(var d=0;d<I.length;d++)if(I[d].identifier==c){c=I[d];break a}c=void 0}c.end.x=b.pageX||b.clientX;c.end.y=b.pageY||b.clientY;return c}function Y(b){if(fa[b])return fa[b].distance}function S(b){return{direction:b,distance:0}}function W(b,c){var d=Math.abs(b.x-c.x),f=Math.abs(b.y-c.y);return Math.round(Math.sqrt(d*d+f*f))}function M(){return(new Date).getTime()}var p=e||!d.fallbackToMouseEvents,q=p?"touchstart":"mousedown",r=
p?"touchmove":"mousemove",u=p?"touchend":"mouseup",ca=p?null:"mouseleave",F=0,H=null,D=0,Z=0,aa=0,P=1,U=0,T=0,fa=null,x=b(c),A="start",B=0,I=null,ha=0,ea=0,da=0,ga=0,ba=0,ia=null;try{x.bind(q,h),x.bind("touchcancel",m)}catch(ja){b.error("events not supported "+q+",touchcancel on jQuery.swipe")}this.enable=function(){x.bind(q,h);x.bind("touchcancel",m);return x};this.disable=function(){v();return x};this.destroy=function(){v();x.data("TouchSwipe",null);return x};this.option=function(c,f){if(void 0!==
d[c]){if(void 0===f)return d[c];d[c]=f}else b.error("Option "+c+" does not exist on jQuery.swipe.options");return null}}var e="ontouchstart"in window;b.fn.swipe=function(d){var e=b(this),h=e.data("TouchSwipe");if(h&&"string"===typeof d){if(h[d])return h[d].apply(this,Array.prototype.slice.call(arguments,1));b.error("Method "+d+" does not exist on jQuery.swipe")}else if(!(h||"object"!==typeof d&&d))return c.apply(this,arguments);return e};b.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,
pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"};b.fn.swipe.phases={PHASE_START:"start",PHASE_MOVE:"move",
PHASE_END:"end",PHASE_CANCEL:"cancel"};b.fn.swipe.directions={LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down",IN:"in",OUT:"out"};b.fn.swipe.pageScroll={NONE:"none",HORIZONTAL:"horizontal",VERTICAL:"vertical",AUTO:"auto"};b.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:"all"}});function LookupCreator(){this.type="LookupCreator";this.options={};this.popup=null}LookupCreator.prototype.init=function(b){this.options=b;var c=this;this.options.lookupButton&&this.options.lookupButton.click(function(){c.show()});return this};
LookupCreator.prototype.show=function(){var b=this,c={type:"TableCreator",clickable:!0,linesPerPage:10,hideHeader:!0};for(key in this.options.tableOptions)c[key]=this.options.tableOptions[key];c.onClick=function(c){"function"===typeof b.options.onLookup&&(b.popup.close(),b.options.onLookup.call(b,c))};var d={};for(key in this.options.popupOptions)d[key]=this.options.popupOptions[key];d.title||(d.title="Lookup");if(!d.content)if(!0===this.options.searchBar){var e={type:"SearchBar",delayedSearch:100,
onSearch:function(b){this.popupCreator.contentObjects[1].reloadData(b)}};for(key in this.options.searchBarOptions)e[key]=this.options.searchBarOptions[key];d.content=[e,c]}else d.content=c;this.popup=new PopupCreator;this.popup.init(d);this.popup.show(function(){!0===b.options.searchBar&&b.popup.element.find(".sbbar").focus()})};function Notifier(){this.type="Notifier";this.options={};this.element=null}Notifier.prototype.init=function(b){this.options=b;return this};
Notifier.prototype.show=function(b,c){var d=this;void 0===d.options.text&&(d.options.text=b);void 0===d.options.timeout&&(d.options.timeout=c);this.element=$("<div/>",{"class":"notifier"});this.element.append(this.options.text);0<$("div.tbcbar").length&&this.element.css("transform","translate(0px,-30px)");$("body").append(this.element);this.element.fadeIn("fast");setTimeout(function(){d.element.fadeOut("fast",function(){d.element.remove()})},isNaN(this.options.timeout)?2E3:this.options.timeout)};var clickHandlerRegisteredForTableCreator=!1,lastDocumentClickLoaction={x:0,y:0};function PopupCreator(){this.type="TableCreator";this.options={};this.tab=0;this.minimizedElement=this.element=null;this.minHeight=this.resizeStartHeight=this.resizeStartWidth=this.resizeStartY=this.resizeStartX=this.moveStartOffsetY=this.moveStartOffsetX=0;this.isLoading=this.isHidden=!1;this.cachedSetup={};this.contentObjects=[];this.startMaximized=this.keepMinimizedLink=!1}
PopupCreator.prototype.init=function(b){this.options=b;"undefined"!==typeof Storage&&void 0!==this.options.typeId&&(void 0===localStorage.PopupCreatorCachedSetup&&(localStorage.PopupCreatorCachedSetup=JSON.stringify({})),this.cachedSetup=JSON.parse(localStorage.PopupCreatorCachedSetup)[this.options.typeId],void 0===this.cachedSetup&&(this.cachedSetup={}));var c=this;$(document).keydown(function(b){void 0===c||void 0===c.element?c=void 0:27==b.keyCode&&!1!==c.allowClose&&c.isVisible()&&parseInt(c.element.css("z-index"))==
c.getHighestZIndex()&&c.close()});this.element=$("<div class='pcpopup'></div>");$("body").append(this.element);this.element.mousedown(function(){c.focus()});!0===this.options.modal&&0>=$("body").find(".pcoverlay").length&&($("body").append("<div class='pcoverlay'></div>"),this.options.allowClose&&$("body").find(".pcoverlay").click(function(){c.close()}));clickHandlerRegisteredForTableCreator||($(document).click(function(b){lastDocumentClickLoaction={x:b.clientX,y:b.clientY}}),clickHandlerRegisteredForTableCreator=
!0);return this};PopupCreator.prototype.focus=function(){this.element.css("z-index",this.getHighestZIndex()+1)};PopupCreator.prototype.hasFocus=function(){return this.getHighestZIndex()==parseInt(this.element.css("z-index"))};PopupCreator.prototype.getHighestZIndex=function(){var b=0;$("div.pcpopup").each(function(){var c=parseInt($(this).css("zIndex"),10);c>b&&(b=c)});return b};
PopupCreator.prototype.show=function(b){var c=this;this.startMaximized=!0===this.options.maximize||!0===this.cachedSetup.isMaximized;this.element.css("z-index",this.getHighestZIndex()+1);if(!this.restore()&&!this.element.is(":visible"))if(!0===this.isHidden)c.isHidden=!1,this.element.fadeIn(100,function(){});else{var d=$("<div/>",{"class":"pctopdiv pcinner"}),e=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";d.on(e,function(b){var d=c.element.width()/Math.max(.01,c.element.height());
0<(/Firefox/i.test(navigator.userAgent)?b.originalEvent.detail:b.originalEvent.wheelDelta)/120?(c.element.width(Math.max(250,parseInt(c.element.width())+30*d)),c.element.height(Math.max(100,parseInt(c.element.height())+30*d))):(c.element.width(Math.max(250,parseInt(c.element.width())-30*d)),c.element.height(Math.max(100,parseInt(c.element.height())-30*d)));c.fixSizing()});d.dblclick(function(b){0==b.button&&(c.element.hasClass("pcpopupmaximized")?c.restore():c.maximize())});d.bind("mouseup",function(b){2==
b.which&&c.close()});void 0!==this.options.title&&(e=$("<div class='pctitle' unselectable='on' onselectstart='return false;' onmousedown='return false;'>"+this.options.title+"</div>"),d.append(e),"function"===typeof RightClickMenu&&(new RightClickMenu).init(jQuery.extend(!0,{element:e},this.options.rightClickMenu)).attach());if($.isArray(this.options.tabs)){for(var e=$("<div class='pctabs'></div>"),f=0;f<this.options.tabs.length;f++){var g=$("<button class='pctabtitle'></button>");g.data("tabnum",
f);g.mousedown(function(b){b.preventDefault();return!1});g.click(function(){var b=$(this).data("tabnum");c.setTab(b,function(){c.fixSizing()})});e.append(g)}d.append(e);setTimeout(function(){c.refreshTabTitles()},1)}e=$("<div/>",{"class":"pctopctlbtns pcinner"});!1!==this.options.allowMinimize&&(f=$("<img src='/img/min.png' class='pcminimizebtn pctoprighticon' title='Minimize'></img>"),f.click(function(){c.minimize()}),e.append(f));!1!==this.options.allowMaximize&&(window.isMobile()?this.element.addClass("pcpopupmaximized"):
(this.maximizeBtn=$("<img src='/img/max.png' class='pcmaximizebtn pctoprighticon' title='Maximize'></img>"),this.restoreBtn=$("<img src='/img/windowed.png' class='pcmaximizebtn pctoprighticon' title='Restore'></img>"),this.startMaximized?this.maximizeBtn.hide():this.restoreBtn.hide(),this.maximizeBtn.click(function(){c.maximize()}),this.restoreBtn.click(function(){c.restore()}),e.append(this.maximizeBtn),e.append(this.restoreBtn)));!1!==this.options.allowClose&&(f=$("<img src='/img/close.png' class='pcclosebtn pctoprighticon' title='Close'></img>"),
f.click(function(){c.close()}),e.append(f));if(0<d.children().length||0<e.children().length)this.element.append(d),this.element.append(e);d=0;isNaN(this.options.initialTab)||(d=this.options.initialTab);void 0!==this.options.tabs?this.setTab(d,function(){c.contentLoaded(b)}):(d=$("<div class='pccontent pcinner'></div>"),void 0!==this.options.contentStyle&&d.css(this.options.contentStyle),this.appendContent(d,null,function(){c.contentLoaded(b)}))}};
PopupCreator.prototype.contentLoaded=function(b){var c=this;void 0!==this.options.style&&this.element.css(this.options.style);!1!==this.options.moveable&&this.makeMovable();!1!==this.options.resizable&&this.makeResizable();void 0!==this.cachedSetup.width&&20<this.cachedSetup.width&&this.element.css("width",this.cachedSetup.width+"px");void 0!==this.cachedSetup.height&&50<this.cachedSetup.height&&this.element.css("height",this.cachedSetup.height+"px");void 0!==this.cachedSetup.x&&this.element.css("left",
this.cachedSetup.x+"px");void 0!==this.cachedSetup.y&&this.element.css("top",this.cachedSetup.y+"px");!0===this.options.modal&&$("body").find(".pcoverlay").fadeIn(100);this.startMaximized&&!window.isMobile()&&this.maximize();window.isMobile()&&!1!==this.options.allowMaximize&&this.element.height($(window).height()-$("div.tbcbar").height());this.element.append($("<div/>",{"class":"pcresizehover"}));setTimeout(function(){"function"===typeof c.options.onBeforeShow&&c.options.onBeforeShow.call(c);c.fixPosition();
c.isLoading=!0;setTimeout(function(){c.isLoading=!1},500);setTimeout(function(){c.fixSizing()},1);window.isMobile()?(c.element.show(),c.afterShow(b)):c.element.fadeIn({duration:100,complete:function(){c.afterShow(b)}})},1);!1!==this.options.showInTaskbar&&0<$("div.tbctasks").length&&(this.addTaskIcon(),this.keepMinimizedLink=!0)};PopupCreator.prototype.refreshTabTitles=function(){var b=this;this.element.find(".pctabtitle").each(function(c,d){b.refreshTabTitle(c,d,b.options.tabs[c].title)})};
PopupCreator.prototype.refreshTabTitle=function(b,c,d){"function"===typeof d?d.call(this,function(b){$(c).html(b)}):$(c).html(d)};PopupCreator.prototype.afterShow=function(b){var c=this;this.element.css("height",this.element.height()+"px");this.fixSizing();$(window).resize(function(){c.fixSizing()});"function"===typeof b&&b.call(this);"function"===typeof this.options.onShow&&this.options.onShow.call(this)};
PopupCreator.prototype.fixSizing=function(){var b=this.element.find(".pctitle"),c=this.element.find(".pctopctlbtns");this.titleWidth||(this.titleWidth=b.width());if(this.titleWidth>this.element.width()-c.width()-30){var d=this.element.width(),e=b.position().left+(b.outerWidth()-b.width());b.css("width",d-c.width()-e+"px")}else b.css("width","");b=$("div.tbcbar").height();this.element.hasClass("pcpopupmaximized")?this.element.height($(window).height()-$("div.tbcbar").height()):window.isMobile()||(this.element.width()>
$(window).width()&&this.element.css("width",$(window).width()),this.element.height()>$(window).height()&&this.element.css("height",$(window).height()),0>this.element.position().top&&this.element.css("top","0px"),this.element.position().top>$(window).height()-60-b&&this.element.css("top",$(window).height()-60-b),0>this.element.position().left&&this.element.css("left",0),this.element.position().left>$(window).width()-this.element.width()&&this.element.css("left",$(window).width()-this.element.width()),
this.element.outerHeight()+this.element.position().top>$(window).height()-b&&this.element.height($(window).height()-this.element.position().top-2-b));b=this.element.find(".pccontent:visible");0<b.length&&(c=this.element.innerHeight(),c-=b.position().top,c-=parseInt(b.css("padding-top"))|0,c-=parseInt(b.css("padding-bottom"))|0,c-=parseInt(b.css("margin-bottom"))|0,c-=parseInt(b.css("margin-top"))|0,c-=parseInt(b.css("border-top"))|0,b.height(c))};
PopupCreator.prototype.fixPosition=function(){!1!==this.options.centerH&&void 0===this.cachedSetup.x&&this.element.css("left",$(window).width()/2-this.element.width()/2);!0===this.options.centerV&&void 0===this.cachedSetup.x&&this.element.css("top",$(window).height()/2-this.element.height()/2);if(void 0!==lastDocumentClickLoaction&&!1!==this.options.openUnderCursor&&void 0===this.cachedSetup.x&&!this.options.centerH&&!this.options.centerV){var b=Math.min($(window).width()-this.element.width(),Math.max(0,
lastDocumentClickLoaction.x-this.element.width()/2)),c=Math.min($(window).height()-this.element.height(),Math.max(0,lastDocumentClickLoaction.y-Math.min(50,this.element.height()/3)));this.element.css("left",b);this.element.css("top",c)}};
PopupCreator.prototype.makeMovable=function(){var b=this,c=function(c){b.element.offset({top:c.clientY-b.moveStartOffsetY,left:c.clientX-b.moveStartOffsetX})};this.element[0].addEventListener("mousedown",function(d){0==d.button&&($(d.target).hasClass("pctopdiv")||$(d.target).hasClass("pcpopup")||0<$(d.target).parents(".pctopdiv").length)&&(b.element.hasClass("pcpopupmaximized")||(b.moveStartOffsetX=d.clientX-b.element.position().left,b.moveStartOffsetY=d.clientY-b.element.position().top,b.element.css({position:"absolute"})),
b.element.addClass("pcpopupmoving"),window.addEventListener("mousemove",c,!0),d.preventDefault())},!1);window.addEventListener("mouseup",function(d){window.removeEventListener("mousemove",c,!0);void 0!==b&&void 0!==b.element?b.element.removeClass("pcpopupmoving"):b=void 0},!1)};
PopupCreator.prototype.makeResizable=function(){var b=this,c=function(c){b.element.css({position:"absolute",height:Math.max(b.minHeight,b.resizeStartHeight+(c.clientY-b.resizeStartY))+"px",width:b.resizeStartWidth+(c.clientX-b.resizeStartX)+"px"});c.preventDefault();b.fixSizing()};this.element[0].addEventListener("mousedown",function(d){b.resizeStartX=d.pageX;b.resizeStartY=d.pageY;b.resizeStartHeight=b.element.height();b.resizeStartWidth=b.element.width();b.minHeight=Math.max(b.element.find(".pccontent:visible").position().top+
21,b.element.find(".pctopdiv").height());var e=b.resizeStartX-b.element.position().left-(parseInt(b.element.css("margin-left"))|0),f=b.resizeStartY-b.element.position().top-(parseInt(b.element.css("margin-top"))|0);e>b.element.width()-15&&f>b.element.height()-15&&(b.element.hasClass("pcpopupmaximized")||window.addEventListener("mousemove",c,!0),d.preventDefault())},!1);window.addEventListener("mouseup",function(b){window.removeEventListener("mousemove",c,!0)},!1)};
PopupCreator.prototype.setTab=function(b,c){var d=this,e=function(){d.element.find("button.pctabtitle").removeClass("pctabtitlecurrent");d.element.find("button.pctabtitle:nth-child("+(b+1)+")").addClass("pctabtitlecurrent");void 0!==d.options.tabs&&"function"===typeof d.options.tabs[b].onShow&&d.options.tabs[b].onShow.call(d,d.options.tabs[b].content,b);"function"===typeof c&&c.call(d)};this.element.find(".pccontent").hide();var f=this.element.find('.pccontent[data-tabnum="'+b+'"]');0<f.length?(f.show(),
this.fixSizing(),e()):(f=$("<div class='pccontent pcinner'></div>"),f.attr("data-tabnum",""+b),void 0!==this.options.tabs[b].style&&f.css(this.options.tabs[b].style),this.appendContent(f,b,function(){e()}))};
PopupCreator.prototype.appendContent=function(b,c,d){var e=this,f=void 0!==this.options.tabs?this.options.tabs[c].content:this.options.content,g=void 0!==this.options.tabs?this.options.tabs[c].contentExternal:this.options.contentExternal;c=void 0!==this.options.tabs?this.options.tabs[c].contentIFrame:this.options.contentIFrame;if(void 0!==f){for(var f=$.isArray(f)?f:[f],h=0;h<f.length;h++)if("object"===typeof f[h]&&"TableCreator"===f[h].type){g="pctc"+h+""+(new Date).getTime();c=$("<div id='"+g+"'></div>");
b.append(c);this.element.append(b);var l=new TableCreator;c=jQuery.extend(!0,{},f[h]);c.elementId=g;l.init(c);l.popupCreator=this;l.draw(function(){e.isLoading&&e.fixPosition()});this.contentObjects[h]=l}else"object"===typeof f[h]&&"SearchBar"===f[h].type?(g="pcsb"+h+""+(new Date).getTime(),c=$("<div id='"+g+"'></div>"),b.append(c),this.element.append(b),l=new SearchBar,c=jQuery.extend(!0,{},f[h]),c.elementRef=g,l.init(c),l.popupCreator=this,l.show(),this.contentObjects[h]=l):"object"===typeof f[h]&&
"DesktopCreator"===f[h].type?(g="pcdc"+h+""+(new Date).getTime(),c=$("<div id='"+g+"'></div>"),b.append(c),this.element.append(b),l=new DesktopCreator,c=jQuery.extend(!0,{},f[h]),c.elementRef=g,l.init(c),l.popupCreator=this,l.show(),this.contentObjects[h]=l):(b.append(f[h]),this.element.append(b));d()}else void 0!==g?"string"===typeof g&&b.load(g,function(){e.element.append(b);d()}):void 0!==c?"string"===typeof c&&(f=$("<iframe/>",{src:c,"class":"pccontent"}),e.element.append(f),this.contentObjects[h]=
f,d()):d()};PopupCreator.prototype.close=function(){var b=this;this.saveSetup();b.minimizedElement&&b.minimizedElement.remove();this.element.fadeOut(100,function(){!0===b.options.hideOnClose?b.isHidden=!0:(b.element.remove(),b.element=void 0,b.contentObjects=void 0);"function"===typeof b.options.onClose&&b.options.onClose.call(b)});!0===this.options.modal&&$("body").find(".pcoverlay").fadeOut(100)};
PopupCreator.prototype.saveSetup=function(){if("undefined"!==typeof Storage&&void 0!==this.options.typeId){void 0===this.cachedSetup&&(this.cachedSetup={});var b=this.element.hasClass("pcpopupmaximized");b?this.cachedSetup.isMaximized=!0:this.cachedSetup={width:this.element.width(),height:this.element.height(),x:this.element.position().left,y:this.element.position().top,isMaximized:b};b=JSON.parse(localStorage.PopupCreatorCachedSetup);b[this.options.typeId]=this.cachedSetup;localStorage.PopupCreatorCachedSetup=
JSON.stringify(b)}};PopupCreator.prototype.minimize=function(){this.element.hasClass("pcpopupmaximized")||(this.originalWidth=this.element.width(),this.originalHeight=this.element.height());this.addTaskIcon();this.element.addClass("pcpopupminimized");this.element.css("z-index",0)};
PopupCreator.prototype.addTaskIcon=function(){if(!this.minimizedElement){var b=$("#pcminimizedtabls");1>b.length&&(b=$("div.tbctasks"),this.keepMinimizedLink=!0);1>b.length&&(b=$("<div id='pcminimizedtabls'></div>"),$("body").append(b));var c=this;this.minimizedElement=$("<div></div>",{"class":"tbctask"});void 0!==this.options.icon&&this.minimizedElement.append($("<img/>",{src:this.options.icon}));this.minimizedElement.append($("<span/>",{text:this.options.title}));this.minimizedElement.click(function(b){1==
b.which?c.element.hasClass("pcpopupminimized")?c.restore():c.hasFocus()?c.minimize():(c.focus(),c.element.addClass("pcfocused-animation"),setTimeout(function(){c.element.removeClass("pcfocused-animation")},200)):2==b.which&&c.close()});b.append(this.minimizedElement)}};
PopupCreator.prototype.restore=function(){var b=!1;this.element.hasClass("pcpopupminimized")?(this.element.removeClass("pcpopupminimized"),this.focus(),!0!==this.keepMinimizedLink&&this.minimizedElement.remove(),b=!0):this.element.hasClass("pcpopupmaximized")&&(this.element.removeClass("pcpopupmaximized"),this.restoreBtn.hide(),this.maximizeBtn.show(),isNaN(this.originalWidth)||(this.element.width(this.originalWidth),this.element.height(this.originalHeight)),b=!0);b&&this.fixSizing();return b};
PopupCreator.prototype.maximize=function(){this.originalWidth=this.element.width();this.originalHeight=this.element.height();this.restoreBtn.show();this.maximizeBtn.hide();this.element.height($(window).height()-$("div.tbcbar").height());this.element.addClass("pcpopupmaximized");this.fixSizing()};PopupCreator.prototype.hide=function(){this.element.hide();this.isHidden=!0};PopupCreator.prototype.isVisible=function(){return!0!==this.isHidden&&this.element.is(":visible")?!0:!1};
PopupCreator.prototype.print=function(b){var c=this.element.find(".pccontent").clone(!1,!1);if(b)for(var d in b)c.find(d).css(b[d]);var e=new PopupCreator;e.init({title:"Print table contents",contentIFrame:"",style:{width:"800px",height:"400px"},onShow:function(){this.element.find("iframe").contents().find("body").append(c);var b=this.element.find("iframe")[0];(b.contentWindow||b).print();this.element.find("iframe").contents().keydown(function(b){27==b.keyCode&&(e.close(),document.activeElement&&
document.activeElement.blur())})}});e.show()};
void 0===window.isMobile&&(isMobile=function(){var b=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,4)))b=
!0;return b});function RightClickMenu(){this.type="RightClickMenu";this.options={};this.popup=this.element=null;this.isNested=!1;this.startMenuMouseOutTimer=0}RightClickMenu.prototype.init=function(b){this.options=b;return this};
RightClickMenu.prototype.attach=function(){var b=this;"string"===typeof this.options.elementRef?this.element=$("#"+this.options.elementRef):"object"===typeof this.options.element&&(this.element=this.options.element);this.element||console.log("ERROR: No element for RightClickMenu options");this.element.on("contextmenu",function(c){2===c.button&&(b.show(c),c.preventDefault())})};
RightClickMenu.prototype.show=function(b){var c=this,d=[];if($.isArray(c.options.actions)){!0===c.options.sort&&(c.options.actions=c.options.actions.sort(function(b,c){return b.title<c.title?-1:1}));for(var e=0;e<c.options.actions.length;e++){var f=$("<div/>",{"class":"rcmitem",html:c.options.actions[e].title});f.data("rcmitem",c.options.actions[e]);f.click(function(b){b=$(this).data("rcmitem");"function"===typeof c.options.onClickOverride?c.options.onClickOverride.call(c,b,c.element):"function"===
typeof b.onClickOverride?b.onClickOverride.call(c,b,c.element):"function"===typeof b.onClick&&b.onClick.call(c,b,c.element);c.popup.close()});d.push(f)}}else d.push($("<div/>",{html:"No actions available"}));this.popup=new PopupCreator;this.popup.init({centerH:!1,centerV:!1,allowMinimize:!1,allowMaximize:!1,allowClose:!1,contentStyle:{padding:"0px",margin:"0px"},showInTaskbar:!1,moveable:!1,resizable:!1,openUnderCursor:!1,style:{left:b.pageX+"px",top:b.pageY+"px","min-width":"50px","min-height":"20px"},
content:d});this.popup.show();this.popup.element.mouseleave(function(){c.startMenuMouseOutTimer=setTimeout(function(){null!=c.popup&&c.popup.close()},300)});this.popup.element.mouseenter(function(){clearTimeout(c.startMenuMouseOutTimer)})};function SearchBar(b){this.type="SearchBar";this.options={};this.element=null;this.isNested=!1;this.language=b?b:"en";this.translations={da:{search:"S\u00f8g"},en:{search:"Search"}}}SearchBar.prototype.init=function(b){this.options=b;void 0!==b&&void 0!==b.language&&(this.language=b.language);return this};
SearchBar.prototype.show=function(){var b=this;"string"===typeof this.options.elementRef?this.element=$("#"+this.options.elementRef):"object"===typeof this.options.elementRef?this.element=this.options.elementRef:(this.element=$("<div></div>"),$("body").append(this.element));this.element.addClass("sbcontainer");void 0!==b.options.style&&this.element.css(b.options.style);var c=$("<input class='sbbar' placeholder='"+this.label("search")+"...'></input>");c.attr("tabindex",-1);c.keydown(function(c){40===
c.which?b.showDropDown():13==c.keyCode&&b.invokeSearch()});c.on("dosearch",function(){b.invokeSearch()});c[0].oninput=function(){if("number"===typeof b.options.delayedSearch){clearTimeout(b.delayTimer);var c=b.options.delayedSearch;if(isNaN(b.options.delayIfCharsBelow)||b.element.find(".sbbar").val().length<b.options.delayIfCharsBelow)c*=isNaN(b.options.delayIfCharsBelow)?2:b.options.delayIfCharsBelow;b.delayTimer=setTimeout(function(){b.invokeSearch()},c)}else b.invokeSearch()};this.element.append(c);
void 0!==this.options.dropDownItems&&(c.addClass("sbbarwithdownarrow"),c=$("<img/>",{src:"/img/downarrow.png","class":"sbdownarrow"}),c.click(function(){b.element.find(".sbdropdown").is(":visible")?b.hideDropDown():b.showDropDown()}),this.element.append(c),c=$("<div/>",{"class":"sbdropdown"}),c.append("<table><tbody></tbody></table> "),this.element.append(c))};SearchBar.prototype.invokeSearch=function(){"function"===typeof this.options.onSearch&&this.options.onSearch.call(this,this.element.find(".sbbar").val())};
SearchBar.prototype.hideDropDown=function(){var b=this.element.find(".sbdropdown"),c=this.element.find(".sbbar");b.slideUp("fast");c.prop("disabled",!1);"function"===typeof isMobile&&isMobile()||c.focus()};
SearchBar.prototype.showDropDown=function(){var b=this,c=this.element.find(".sbdropdown"),d=this.element.find(".sbbar");c.css("top",d.position().top+d.outerHeight()+1);c.css("left",d.position().left);c.css("width",d.outerWidth());var e=c.find("tbody");e.empty();this.getDropDownItems(function(f){if($.isArray(f)){for(i in f){var g=$("<tr/>");g.data("item",f[i]);g.data("searchidx",i);g.data("sb",b);g.click(b.onDropDownEvent);g.keydown(b.onDropDownEvent);g.attr("tabindex",-1);var h=$("<td/>");h.html(void 0!==
f[i].title?f[i].title:f[i].Title);g.append(h);e.append(g)}c.show()}d.prop("disabled",!0);c.find("tbody tr:first").focus()})};SearchBar.prototype.getDropDownItems=function(b){$.isArray(this.options.dropDownItems)?b(this.options.dropDownItems):"function"===typeof this.options.dropDownItems&&this.options.dropDownItems.call(this,function(c){b(c)})};
SearchBar.prototype.onDropDownEvent=function(b){var c=parseInt($(this).data("searchidx")),d=$(this).data("item").query;void 0===d&&(d=$(this).data("item").Query);var e=$(this).data("sb"),f=$(this).closest(".sbcontainer").find(".sbbar"),g=$(this).closest(".sbcontainer").find(".sbdropdown"),h=g.find("tbody tr").length;if(void 0==b||13==b.which||"click"==b.type&&0==b.button)f.val(d),e.hideDropDown(),e.invokeSearch();else{if(39==b.which)return h>c+4?g.find("tbody tr")[c+4].focus():0<h&&g.find("tbody tr")[h-
1].focus(),b.preventDefault(),!1;if(40==b.which)return h>c+1&&g.find("tbody tr")[c+1].focus(),b.preventDefault(),!1;37==b.which?(0<h&&4<=c?g.find("tbody tr")[c-4].focus():0<h&&g.find("tbody tr")[0].focus(),b.preventDefault()):38==b.which&&(0<h&&0<c?g.find("tbody tr")[c-1].focus():e.hideDropDown(),b.preventDefault())}};SearchBar.prototype.label=function(b){return this.translations[this.language][b]};function TableCreator(b){this.type="TableCreator";this.options={};this.data=[];this.page=0;this.linesPerPage=Number.MAX_VALUE;this.lastReloadCalled=0;this.lastQuery=void 0;this.cachedSetup={};this.language=b?b:"en";this.fieldSelectMouseOutTimer=null;this.translations={da:{save:"Gem",close:"Luk",cancel:"Annuller",create:"Opret",all:"Alle",choosefields:"V\u00e6lg felter",loading:"Henter",editrecord:"Rediger post",deleterow:"Slet post",newrecord:"Ny post",viewrecord:"Vis post",noresults:"Ingen resultater",
invaliddata:"Ugyldig data",deleteconfirm:"Er du sikker p\u00e5 at du vil slette denne post?",show:"Vis","new":"Ny"},en:{save:"Save",close:"Close",cancel:"Cancel",create:"Create",all:"All",choosefields:"Choose fields",loading:"Loading",editrecord:"Edit record",deleterow:"Delete record",newrecord:"New record",viewrecord:"View record",noresults:"No results",invaliddata:"Invalid data",deleteconfirm:"Are you sure that you want to delete this record?",show:"Show","new":"New"}}}
TableCreator.prototype.init=function(b){this.options=b;void 0!==b&&void 0!==b.language&&(this.language=b.language);"undefined"!==typeof Storage&&void 0!==this.options.typeId&&(void 0===localStorage.TableCreatorCachedSetup&&(localStorage.TableCreatorCachedSetup=JSON.stringify({})),this.cachedSetup=JSON.parse(localStorage.TableCreatorCachedSetup)[this.options.typeId],void 0===this.cachedSetup&&(this.cachedSetup={}));return this};
TableCreator.prototype.setData=function(b){this.data=b;this.page=0;this.isLoading=!1;void 0!==this.loadingDiv&&this.loadingDiv.fadeOut("fast");this.refreshData()};TableCreator.prototype.rowClicked=function(b){};
TableCreator.prototype.setLinesPerPage=function(b){b=$("#"+this.options.elementId+" div.tcheader select").val();isNaN(b)?this.linesPerPage="all"==b?Number.MAX_VALUE:this.cachedSetup.linesPerPage?this.cachedSetup.linesPerPage:this.options.linesPerPage?this.options.linesPerPage:Number.MAX_VALUE:this.linesPerPage=parseInt(b)};
TableCreator.prototype.draw=function(b){this.setLinesPerPage();if(void 0!==this.options.elementId&&"object"===typeof this.data){var c=$("#"+this.options.elementId);c.empty();void 0!==this.options.style&&c.css(this.options.style);var d=$("<table class='tctable'><thead></thead><tbody></tbody></table>"),e=Math.max(Math.min(this.page*this.linesPerPage,this.data.length),0),f=Math.min(e+this.linesPerPage,this.data.length)-1,g=$("<div class='tcdiv'></div>"),h=this;if(!0!==this.options.hideHeader){var l=
$("<div class='tcheader'></div>"),n=$("<span class='tcleft'></span>");if(!0===h.options.showRecordsPerPageSelector){n.append(h.label("show")+" ");var m="<option value='10'>10</option><option value='20'>20</option><option value='50'>50</option><option value='100'>100</option><option value='all'>"+this.label("all")+"</option>",m=$("<select>"+m+"</select>");m.val(this.linesPerPage<Number.MAX_VALUE?this.linesPerPage:"all");m.change(function(){h.refreshData()});n.append(m)}l.append(n);n=$("<span class='tcright'></span>");
void 0!==this.options.createRecord&&(m=$("<button></button>",{html:this.label("new")}),m.click(function(){h.showRecordPopup(function(b){h.options.createRecord.onCreate.call(h,b,function(){h.reloadData()})})}),n.append(m));!1===h.options.showPrint||window.isMobile()||(m=$("<button title='Print'><img style='width:15px;height:12px' src='/img/print.png'></img></button>"),m.click(function(){var b=$("#"+h.options.elementId).find("table.tctable").clone(!1,!1);b.css({"border-spacing":"0px"});b.find("td.tceditcell").remove();
b.find("td.tcdeletecell").remove();b.find("td.tceditheader").remove();b.find("td.tcdeleteheader").remove();b.find("th").css({"border-bottom":"1px solid black","text-align":"left","padding-right":"10px"});b.find("td").css({"border-bottom":"1px solid gray","padding-right":"10px"});var c=new PopupCreator;c.init({title:"Print table contents",contentIFrame:"",style:{width:"800px",height:"400px"},onShow:function(){this.element.find("iframe").contents().find("body").append(b);var d=this.element.find("iframe")[0];
(d.contentWindow||d).print();this.element.find("iframe").contents().keydown(function(b){27==b.keyCode&&(c.close(),document.activeElement&&document.activeElement.blur())})}});c.show()}),n.append(m));void 0!==this.options.dataSource&&(m=$("<button title='Refresh'><img style='width:15px;height:12px' src='/img/refresh.png'></img></button>"),m.click(function(){h.reloadData()}),n.append(m));!0===h.options.showFieldsSelector&&(m=$("<button></button>",{html:this.label("choosefields")}),m.click(function(){h.toggleFieldsPopup()}),
n.append(m));m=$("<div class='tcfieldspopup tcpopup'><table></table></div>");n.append(m);m=$("<div class='tcrecordpopup tcpopup'></div>");n.append(m);l.append(n);g.append(l)}g.append(d);!0!==this.options.hideFooter&&(d=$("<div class='tcfooter'></div>"),e=$("<span class='tcleft tclinecount'>"+(0<this.data.length?e+1:0)+" - "+(0<this.data.length?Math.max(f,0)+1:0)+" \u00b4("+this.data.length+" total)</span>"),f=$("<span class='tcright'></span>"),l=$("<button class='nextbutton'>\u00bb</button>"),l.click(function(){h.nextPage()}),
n=$("<button class='prevbutton'>\u00ab</button>"),n.click(function(){h.prevPage()}),f.append(n),f.append(l),d.append(e),d.append(f),g.append(d));c.append(g);this.loadingDiv=$("<div/>",{"class":"tcloading",html:this.label("loading")+"..."});c.append(this.loadingDiv);h.reloadData(void 0,b)}};
TableCreator.prototype.refreshData=function(b,c){var d=this;this.setLinesPerPage();var e=$("#"+this.options.elementId+" table.tctable tbody"),f=$("#"+this.options.elementId+" table.tctable thead");e.empty();f.empty();if(void 0===this.options.columns||1==this.options.autoCreateColumns){var g=$.isArray(this.data)?this.data[0]:{};this.options.columns=[];for(key in g)this.options.columns.push({title:key,dataKey:key});this.options.autoCreateColumns=!0}if($.isArray(this.options.columns)){for(col in this.options.columns)if("object"!=
typeof this.options.columns[col]||!1!==this.options.columns[col].visible)g=$("<th>"+("string"===typeof this.options.columns[col]?this.options.columns[col]:this.options.columns[col].title)+"</th>"),g.data("col",col),void 0!==this.options.columns[col].width&&g.css("width",this.options.columns[col].width),g.click(function(){var b=$(this).data("col");b!=d.options.orderByColumn?(d.options.orderByColumn=b,d.options.orderASC=!0):d.options.orderASC=!0===d.options.orderASC?!1:!0;d.refreshData()}),f.append(g);
"object"===typeof this.options.editRecord&&f.append("<th class='tceditheader'></th>");"object"===typeof this.options.deleteRecord&&f.append("<th class='tcdeleteheader'></th>")}if(void 0!==this.options.columns){if(void 0!==this.options.recordRightClickMenu)for(a in this.options.recordRightClickMenu.actions)this.options.recordRightClickMenu.actions[a].onClickOverride=function(b,c){var f=$(c).data("ui-idx"),f=d.data[f];"function"===typeof b.onClick&&b.onClick.call(d,b,f,function(){d.reloadData()})};
this.options.orderByColumn&&$.isArray(this.data)&&"object"===typeof d.options.columns[d.options.orderByColumn]&&this.data.sort(function(b,c){var f=d.options.columns[d.options.orderByColumn].dataKey,e=b[f]||"",f=c[f]||"";"string"===typeof e&&(e=e.toLowerCase());"string"===typeof f&&(f=f.toLowerCase());return e<f?d.options.orderASC?-1:1:d.options.orderASC?1:-1});for(var g=Math.max(Math.min(this.page*this.linesPerPage,this.data.length),0),h=Math.min(g+this.linesPerPage,this.data.length)-1,l=g;l<=h&&
!this.isLoading;l++){f=$("<tr></tr>");f.data("ui-idx",l);f.data("tcrowdata",d.data[l]);!1!==d.options.allowDrag&&(f.attr("draggable","true"),f[0].addEventListener("dragstart",function(b){b.dataTransfer.setData("record",JSON.stringify($(this).data("tcrowdata")));b.dataTransfer.setData("tcoptions",JSON.stringify(d.options))}));!0===this.options.clickable&&f.addClass("clickable");void 0!==this.options.recordRightClickMenu&&(new RightClickMenu).init(jQuery.extend(!0,{element:f},this.options.recordRightClickMenu)).attach();
for(var n=0;n<this.options.columns.length;n++)if("object"!=typeof this.options.columns[n]||!1!==this.options.columns[n].visible){var m=$("<td></td>");m.append(this.data[l][this.options.columns[n].dataKey]);!0===this.options.clickable&&(m.data("ui-idx",l),m.click(function(b){b=$(this).data("ui-idx");d.recordClicked(d.data[b],b)}));this.options.hideFooter&&l==h&&(0==n&&m.css("border-bottom-left-radius","5px"),n==this.options.columns.length-1&&m.css("border-bottom-right-radius","5px"));f.append(m)}"object"===
typeof this.options.editRecord&&(n=$("<td class='tceditcell'><img src='/img/edit.ico' title='"+this.label("editrecord")+"'></img></td>"),n.data("tcdatarecord",this.data[l]),d=this,n.click(function(){d.editRecord($(this).data("tcdatarecord"))}),f.append(n));"object"===typeof this.options.deleteRecord&&(n=$("<td class='tcdeletecell'><img src='/img/delete.png' title='"+this.label("deleterow")+"'></img></td>"),n.data("tcdatarecord",this.data[l]),d=this,n.click(function(){d.deleteRecord($(this).data("tcdatarecord"))}),
f.append(n));e.append(f)}0!=this.data.length||this.isLoading?this.isLoading&&e.append("<tr><td style='text-align: center' colspan='100'>"+this.label("loading")+"...</td></tr>"):e.append("<tr><td style='text-align: center' colspan='100'>"+this.label("noresults")+"</td></tr>");$("#"+this.options.elementId+" span.tclinecount").html((0<this.data.length?g+1:0)+" - "+(0<this.data.length?Math.max(h,0)+1:0)+" ("+this.data.length+" total)");$("#"+this.options.elementId+" button.prevbutton").toggle(this.prevPage(!0));
$("#"+this.options.elementId+" button.nextbutton").toggle(this.nextPage(!0));this.saveSetup();void 0!==this.popupCreator&&this.popupCreator.fixSizing()}};TableCreator.prototype.editRecord=function(b){var c=this;"function"===typeof this.options.editRecord.onEdit&&this.showRecordPopup(function(d){for(key in b)void 0===d[key]&&(d[key]=b[key]);c.options.editRecord.onEdit.call(c,b,d,function(){c.reloadData()})},b)};
TableCreator.prototype.deleteRecord=function(b){if("function"===typeof this.options.deleteRecord.onDelete&&(!1===this.options.confirmDelete||window.confirm(this.label("deleteconfirm")))){var c=this;this.options.deleteRecord.onDelete.call(this,b,function(){c.reloadData()})}};
TableCreator.prototype.recordClicked=function(b,c){"function"===typeof this.options.onClick&&this.options.onClick.call(this,b,c);if("object"===typeof this.options.showRecord&&(this.showRecordPopup(function(){},b,!0),t=this,"function"===typeof this.options.showRecord.onShow))this.options.showRecord.onShow(b,function(){t.reloadData()})};TableCreator.prototype.nextPage=function(b){return(this.page+1)*this.linesPerPage<this.data.length?(b||(this.page++,this.refreshData()),!0):!1};
TableCreator.prototype.prevPage=function(b){return 0<this.page?(b||(this.page--,this.refreshData()),!0):!1};
TableCreator.prototype.toggleFieldsPopup=function(){var b=$("#"+this.options.elementId+" div.tcfieldspopup");if(!b.is(":visible")){$("#"+this.options.elementId+" div.tcpopup").hide();var c=b.find("table");c.empty();var d=this;if("object"==typeof this.options.columns)for(col in this.options.columns){var e=$("<tr class='"+(!1===this.options.columns[col].visible?"disabled":"enabled")+"'><td></td><td>"+("string"===typeof this.options.columns[col]?this.options.columns[col]:this.options.columns[col].title)+
"</td></tr>");e.data("column",col);e.click(function(){$(this).is(".enabled")?($(this).removeClass("enabled").addClass("disabled"),d.options.columns[$(this).data("column")].visible=!1):($(this).removeClass("disabled").addClass("enabled"),d.options.columns[$(this).data("column")].visible=!0);d.refreshData()});c.append(e)}}b.toggle();var d=this,f=setTimeout(function(){null!=b&&b.fadeOut("fast")},1E3);b.mouseleave(function(){f=setTimeout(function(){null!=b&&b.hide()},300)});b.mouseenter(function(){clearTimeout(f)})};
TableCreator.prototype.showRecordPopup=function(b,c,d){if("function"===typeof this.options.createRecord.overrideCreate)this.options.createRecord.overrideCreate.call(this,b,c,d);else if("function"===typeof PopupCreator){var e=new PopupCreator,f={},g=$("<div/>",{"class":"tceditrecord"}),h=this,l={};void 0===c?(f.title=this.label("newrecord"),l=this.options.createRecord):!0===d?(f.title=this.label("viewrecord"),l=this.options.showRecord):(f.title=this.label("editrecord"),l=this.options.editRecord);void 0!==
l.title&&(f.title=l.title);if($.isArray(l.fields)){var n=$("<table></table>"),m=null;for(col in l.fields){var w=$("<tr></tr>"),v=$("<td>"+("string"===typeof l.fields[col]?l.fields[col]:l.fields[col].title)+"</td>");w.append(v);v=void 0;"textarea"==l.fields[col].type?v=$("<textarea></textarea>"):"select"==l.fields[col].type?(v=$("<select></select>"),this.appendControlValues(v,l.fields[col].values,"object"===typeof c?c[l.fields[col].name]:l.fields[col].value),d&&v.prop("disabled",!0)):"checkbox"==l.fields[col].type?
(v=$("<input type='checkbox'></input>"),v.attr("checked","object"!==typeof c?!1:c[l.fields[col].name]?!0:!1)):(v=$("<input type='text'></input>"),void 0!==l.fields[col].placeholder&&v.attr("placeholder",l.fields[col].placeholder));"object"===typeof c?v.val(c[l.fields[col].name]):"function"===typeof l.fields[col].value?v.val(l.fields[col].value()):void 0!==l.fields[col].value&&v.val(l.fields[col].value);d&&v.prop("readonly",!0);void 0!==l.fields[col].style&&v.css(l.fields[col].style);var z=$("<td></td>");
z.append(v);w.append(z);n.append(w);null==m&&(m=v)}w=$("<tr class='internal'></tr>");w.append("<td></td>");v=$("<td></td>");!0!==d&&(z=$("<button class='tcbutton'>"+(void 0!==c?this.label("save"):this.label("create"))+"</button>"),z.click(function(){"function"===typeof l.onBeforeCreate&&l.onBeforeCreate.call(e,g);if("function"===typeof b){var d={};e.element.find("table tr").each(function(b){var f=void 0;$(this).is(".internal")||(0<$(this).find("input").length?f="checkbox"==l.fields[b].type?$(this).find("input").is(":checked"):
$(this).find("input").val():0<$(this).find("textarea").length?f=$(this).find("textarea").val():0<$(this).find("select").length&&(f=$(this).find("select").val()));void 0!==f&&(void 0!==c?d[h.options.editRecord.fields[b].name]=f:d[h.options.createRecord.fields[b].name]=f)});var f=!0;"function"===typeof l.validate&&(f=void 0!==c?l.validate(c,d):l.validate(d));!0===f?(b(d),e.close()):("string"===typeof f?e.element.find(".tcnewrecorderror").html(f):$("#"+h.options.elementId+" td.tcnewrecorderror").html(h.label("invaliddata")),
"function"===typeof l.onValidationEror&&l.onValidationEror.call(e,g,d))}}),v.append(z));d=$(!0===d?"<button class='tcbutton'>"+h.label("close")+"</button>":"<button class='tcbutton'>"+h.label("cancel")+"</button>");d.click(function(){e.close()});v.append(d);v.append($("<span/>",{"class":"tcnewrecorderror"}));w.append(v);n.append(w);g.append(n);g.find("input,select").keypress(function(b){13==b.which&&g.find("button:first").click()});f.content=g;e.init(f);e.show(function(){"function"===typeof l.onShow&&
l.onShow.call(e,g);null!=m&&m.focus();var b=this.element.find(".tceditrecord tr td:first-child");b.width(b.width())})}}};
TableCreator.prototype.appendControlValues=function(b,c,d){if("function"===typeof c)c.call(this,function(c){for(var e=0;e<c.length;e++)"object"===typeof c[e]?b.append("<option value='"+(void 0!==c[e].Id?c[e].Id:c[e].id)+"'>"+(void 0!==c[e].Label?c[e].Label:void 0!==c[e].label?c[e].label:void 0!==c[e].title?c[e].title:c[e].Title)+"</option>"):b.append("<option value='"+e+"'>"+c[e]+"</option>");"function"===typeof d?b.val(d()):void 0!==d&&b.val(d)});else{for(var e=0;e<c.length;e++)"object"===typeof c[e]?
b.append("<option value='"+(void 0!==c[e].Id?c[e].Id:c[e].id)+"'>"+(void 0!==c[e].Label?c[e].Label:c[e].label)+"</option>"):b.append("<option value='"+e+"'>"+c[e]+"</option>");"function"===typeof d?b.val(d()):void 0!==d&&b.val(d)}};
TableCreator.prototype.reloadData=function(b,c){var d=this,e=this.lastReloadCalled=(new Date).getTime();void 0!==this.options.initialData?(d.setData(this.options.initialData),this.options.initialData=void 0,"function"===typeof c&&c()):"function"===typeof this.options.dataSource?(void 0===b&&(b=this.lastQuery),this.lastQuery=b,this.startLoading(),this.options.dataSource.call(this,function(b){e==d.lastReloadCalled&&(d.setData(b),"function"===typeof c&&c())},b)):($.isArray(this.options.data)?d.setData(this.options.data):
this.refreshData(),"function"===typeof c&&c())};TableCreator.prototype.startLoading=function(){var b=$("#"+this.options.elementId);this.isLoading=!0;if(void 0!==b&&void 0!==this.loadingDiv){b=Math.max(b.height()/2,b.height()-200);this.loadingDiv.css("top",-b+"px");var c=this;setTimeout(function(){c.isLoading&&c.loadingDiv.fadeIn("fast")},200)}};
TableCreator.prototype.filterDataFromQuery=function(b,c){var d=c;void 0!==d&&(d=d.toLowerCase(),d=d.split(" "));var e=function(b){var c=!1,e;for(e in d){var c=!1,l;for(l in b)"string"===typeof b[l]&&0<=b[l].toLowerCase().indexOf(d[e])&&(c=!0);if(!c)return!1}return c};return d?b.filter(e):b};
TableCreator.prototype.saveSetup=function(){if("undefined"!==typeof Storage&&void 0!==this.options.typeId){void 0===this.cachedSetup&&(this.cachedSetup={});this.cachedSetup={linesPerPage:this.linesPerPage};var b=JSON.parse(localStorage.TableCreatorCachedSetup);b[this.options.typeId]=this.cachedSetup;localStorage.TableCreatorCachedSetup=JSON.stringify(b)}};TableCreator.prototype.label=function(b){return this.translations[this.language][b]};
void 0===window.isMobile&&(isMobile=function(){var b=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))b=!0;return b});function TaskbarCreator(){this.type="TaskbarCreator";this.element=null;this.options={};this.cachedSetup={};this.startMenuMouseOutTimer=this.startMenuPC=null}
TaskbarCreator.prototype.init=function(b){this.options=b;"undefined"!==typeof Storage&&void 0!==this.options.typeId&&(void 0===localStorage.TaskbarCreatorCachedSetup&&(localStorage.TaskbarCreatorCachedSetup=JSON.stringify({})),this.cachedSetup=JSON.parse(localStorage.TaskbarCreatorCachedSetup)[this.options.typeId],void 0===this.cachedSetup&&(this.cachedSetup={}));var c=this;"string"===typeof this.options.elementRef?this.element=$("#"+this.options.elementRef):"object"===typeof this.options.elementRef?
this.element=this.options.elementRef:(this.element=$("<div></div>"),$("body").append(this.element));this.element.addClass("tbcbar");$(document).keydown(function(b){220==b.which&&c.toggleStartMenu()});this.createMenu();return this};
TaskbarCreator.prototype.saveSetup=function(){if("undefined"!==typeof Storage&&void 0!==this.options.typeId){void 0===this.cachedSetup&&(this.cachedSetup={});this.cachedSetup={};var b=JSON.parse(localStorage.TaskbarCreatorCachedSetup);b[this.options.typeId]=this.cachedSetup;localStorage.TaskbarCreatorCachedSetup=JSON.stringify(b)}};
TaskbarCreator.prototype.show=function(){this.element.empty();var b=$("<img/>",{"class":"tbcstartbutton",src:"/img/programgroup.png",title:"Start Menu"}),c=$("<div/>",{"class":"tbctasks"}),d=$("<div/>",{"class":"tbctray"}),e=this;b.click(function(){e.toggleStartMenu()});this.element.append(b);this.element.append(c);this.element.append(d);window.isMobile()||($(".tbctasks").on("mouseenter","div.tbctask",function(b){var c=$(b.target).hasClass("tbctask")?$(b.target):$(b.target).parent(".tbctask");b=c.find("span").html();
var d=$("<div></div>",{"class":"hoverelement",html:b});c.append(d);setTimeout(function(){var b=(d.width()-c.width())/2+7,b=Math.min(b,c.offset().left-e.element.offset().left);d.css("margin-left",-b+"px");d.fadeIn("fast")},1)}),$(".tbctasks").on("mouseleave","div.tbctask",function(b){($(b.target).hasClass("tbctask")?$(b.target):$(b.target).parent(".tbctask")).find(".hoverelement").remove()}))};
TaskbarCreator.prototype.toggleStartMenu=function(){this.stopMouseOutTimer();null!==this.startMenuPC&&void 0!==this.startMenuPC.element||this.createMenu();this.startMenuPC.isVisible()?this.startMenuPC.hide():(this.startMenuPC.show(),this.startMouseOutTimer(),"function"===typeof this.options.onShow&&this.options.onShow.call(this.startMenuPC))};
TaskbarCreator.prototype.startMouseOutTimer=function(){var b=this;clearTimeout(b.startMenuMouseOutTimer);void 0!==this.startMenuPC&&void 0!==this.startMenuPC.element&&(this.startMenuPC.element.unbind("mouseleave"),this.startMenuPC.element.unbind("mouseenter"),this.startMenuPC.element.mouseleave(function(){b.startMenuMouseOutTimer=setTimeout(function(){null!=b.startMenuPC&&b.startMenuPC.isVisible()&&b.toggleStartMenu()},500)}),this.startMenuPC.element.mouseenter(function(){clearTimeout(b.startMenuMouseOutTimer)}))};
TaskbarCreator.prototype.stopMouseOutTimer=function(){clearTimeout(this.startMenuMouseOutTimer)};
void 0===window.isMobile&&(isMobile=function(){var b=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))b=!0;return b});
TaskbarCreator.prototype.createMenu=function(){this.startMenuPC=new PopupCreator;this.startMenuPC.init({centerH:!1,centerV:!1,openUnderCursor:!1,allowMinimize:!1,allowMaximize:!1,allowClose:!1,contentStyle:{padding:"0px","margin-top":"5px","border-radius":"5px 5px 5px 5px"},showInTaskbar:!1,moveable:!1,resizable:!1,hideOnClose:!0,style:{left:"0px",bottom:"30px",top:"inherit"}});var b=[];if(void 0!==this.options.startMenuDesktop){var c=this.options.startMenuDesktop.options.desktopShortcuts,d=[];for(h in c)if(!c[h].isFolder){var e=
$("<div/>",{"class":"tbcstartmenuitem"}),f=$("<img/>",{src:c[h].icon}),g=$("<span/>");e.data("shortcut",c[h]);e.data("desktop",this.options.startMenuDesktop);e.click(function(){$(this).data("desktop").shortcutClicked.call(this);t.toggleStartMenu()});g.append(c[h].title);e.append(f);e.append(g);d.push(e)}b.push(d)}if(void 0!==this.options.content)if($.isArray(this.options.content))for(var h=0;h<this.options.content.length;h++)b.push(this.options.content[h]);else b.push(this.options.content);c=$("<table></table>",
{"class":"tbcmenutable"});d=$("<tr></tr>");for(h=0;h<b.length;h++)e=$("<td></td>"),e.append(b[h]),d.append(e);c.append(d);this.startMenuPC.options.content=c};
